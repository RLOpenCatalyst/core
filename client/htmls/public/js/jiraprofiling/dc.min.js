(function(){function e(e){"use strict";var t={version:"2.0.0-dev",constants:{CHART_CLASS:"dc-chart",DEBUG_GROUP_CLASS:"debug",STACK_CLASS:"stack",DESELECTED_CLASS:"deselected",SELECTED_CLASS:"selected",NODE_INDEX_NAME:"__index__",GROUP_INDEX_NAME:"__group_index__",DEFAULT_CHART_GROUP:"__default_chart_group__",EVENT_DELAY:40,NEGLIGIBLE_NUMBER:1e-10},_renderlet:null};t.chartRegistry=function(){function n(n){if(!n)n=t.constants.DEFAULT_CHART_GROUP;if(!e[n])e[n]=[];return n}var e={};return{has:function(t){for(var n in e){if(e[n].indexOf(t)>=0)return true}return false},register:function(t,r){r=n(r);e[r].push(t)},deregister:function(t,r){r=n(r);for(var i=0;i<e[r].length;i++){if(e[r][i].anchorName()===t.anchorName()){e[r].splice(i,1);break}}},clear:function(t){if(t){delete e[t]}else{e={}}},list:function(t){t=n(t);return e[t]}}}();t.registerChart=function(e,n){t.chartRegistry.register(e,n)};t.deregisterChart=function(e,n){t.chartRegistry.deregister(e,n)};t.hasChart=function(e){return t.chartRegistry.has(e)};t.deregisterAllCharts=function(e){t.chartRegistry.clear(e)};t.filterAll=function(e){var n=t.chartRegistry.list(e);for(var r=0;r<n.length;++r){n[r].filterAll()}};t.refocusAll=function(e){var n=t.chartRegistry.list(e);for(var r=0;r<n.length;++r){if(n[r].focus)n[r].focus()}};t.renderAll=function(e){var n=t.chartRegistry.list(e);for(var r=0;r<n.length;++r){n[r].render()}if(t._renderlet!==null)t._renderlet(e)};t.redrawAll=function(e){var n=t.chartRegistry.list(e);for(var r=0;r<n.length;++r){n[r].redraw()}if(t._renderlet!==null)t._renderlet(e)};t.disableTransitions=false;t.transition=function(e,n,r){if(n<=0||n===undefined||t.disableTransitions)return e;var i=e.transition().duration(n);if(typeof r==="function"){r(i)}return i};t.units={};t.units.integers=function(e,t){return Math.abs(t-e)};t.units.ordinal=function(e,t,n){return n};t.units.fp={};t.units.fp.precision=function(e){var n=function(e,r){var i=Math.abs((r-e)/n.resolution);if(t.utils.isNegligible(i-Math.floor(i)))return Math.floor(i);else return Math.ceil(i)};n.resolution=e;return n};t.round={};t.round.floor=function(e){return Math.floor(e)};t.round.ceil=function(e){return Math.ceil(e)};t.round.round=function(e){return Math.round(e)};t.override=function(e,t,n){var r=e[t];e["_"+t]=r;e[t]=n};t.renderlet=function(e){if(!arguments.length)return t._renderlet;t._renderlet=e;return t};t.instanceOfChart=function(e){return e instanceof Object&&e.__dc_flag__&&true};t.errors={};t.errors.Exception=function(e){var t=e||"Unexpected internal error";this.message=t;this.toString=function(){return t}};t.errors.InvalidStateException=function(){t.errors.Exception.apply(this,arguments)};t.dateFormat=e.time.format("%m/%d/%Y");t.printers={};t.printers.filters=function(e){var n="";for(var r=0;r<e.length;++r){if(r>0)n+=", ";n+=t.printers.filter(e[r])}return n};t.printers.filter=function(e){var n="";if(e){if(e instanceof Array){if(e.length>=2)n="["+t.utils.printSingleValue(e[0])+" -> "+t.utils.printSingleValue(e[1])+"]";else if(e.length>=1)n=t.utils.printSingleValue(e[0])}else{n=t.utils.printSingleValue(e)}}return n};t.pluck=function(e,t){if(!t)return function(t){return t[e]};return function(n,r){return t.call(n,n[e],r)}};t.utils={};t.utils.printSingleValue=function(e){var n=""+e;if(e instanceof Date)n=t.dateFormat(e);else if(typeof e=="string")n=e;else if(t.utils.isFloat(e))n=t.utils.printSingleValue.fformat(e);else if(t.utils.isInteger(e))n=Math.round(e);return n};t.utils.printSingleValue.fformat=e.format(".2f");t.utils.add=function(e,t){if(typeof t==="string")t=t.replace("%","");if(e instanceof Date){if(typeof t==="string")t=+t;var n=new Date;n.setTime(e.getTime());n.setDate(e.getDate()+t);return n}else if(typeof t==="string"){var r=+t/100;return e>0?e*(1+r):e*(1-r)}else{return e+t}};t.utils.subtract=function(e,t){if(typeof t==="string")t=t.replace("%","");if(e instanceof Date){if(typeof t==="string")t=+t;var n=new Date;n.setTime(e.getTime());n.setDate(e.getDate()-t);return n}else if(typeof t==="string"){var r=+t/100;return e<0?e*(1+r):e*(1-r)}else{return e-t}};t.utils.isNumber=function(e){return e===+e};t.utils.isFloat=function(e){return e===+e&&e!==(e|0)};t.utils.isInteger=function(e){return e===+e&&e===(e|0)};t.utils.isNegligible=function(e){return!t.utils.isNumber(e)||e<t.constants.NEGLIGIBLE_NUMBER&&e>-t.constants.NEGLIGIBLE_NUMBER};t.utils.clamp=function(e,t,n){return e<t?t:e>n?n:e};var n=0;t.utils.uniqueId=function(){return++n};t.utils.nameToId=function(e){return e.toLowerCase().replace(/[\s]/g,"_").replace(/[\.']/g,"")};t.utils.appendOrSelect=function(e,t){var n=e.select(t);if(n.empty())n=e.append(t);return n};t.utils.safeNumber=function(e){return t.utils.isNumber(+e)?+e:0};t.logger={};t.logger.enableDebugLog=false;t.logger.warn=function(e){if(console){if(console.warn){console.warn(e)}else if(console.log){console.log(e)}}return t.logger};t.logger.debug=function(e){if(t.logger.enableDebugLog&&console){if(console.debug){console.debug(e)}else if(console.log){console.log(e)}}return t.logger};t.events={current:null};t.events.trigger=function(e,n){if(!n){e();return}t.events.current=e;setTimeout(function(){if(e==t.events.current)e()},n)};t.filters={};t.filters.RangedFilter=function(e,t){var n=Array(e,t);n.isFiltered=function(e){return e>=this[0]&&e<this[1]};return n};t.filters.TwoDimensionalFilter=function(e){if(e===null){return null}var t=e;t.isFiltered=function(e){return e.length&&e.length==t.length&&e[0]==t[0]&&e[1]==t[1]};return t};t.filters.RangedTwoDimensionalFilter=function(e){if(e===null){return null}var t=e;var n;if(t[0]instanceof Array){n=[[Math.min(e[0][0],e[1][0]),Math.min(e[0][1],e[1][1])],[Math.max(e[0][0],e[1][0]),Math.max(e[0][1],e[1][1])]]}else{n=[[e[0],-Infinity],[e[1],Infinity]]}t.isFiltered=function(e){var t,r;if(e instanceof Array){if(e.length!=2)return false;t=e[0];r=e[1]}else{t=e;r=n[0][1]}return t>=n[0][0]&&t<n[1][0]&&r>=n[0][1]&&r<n[1][1]};return t};t.baseMixin=function(n){function D(){u=n.root().append("svg").attr("width",n.width()).attr("height",n.height());return u}function P(e){if(!n[e]||!n[e]())throw new t.errors.InvalidStateException("Mandatory attribute chart."+e+" is missing on chart[#"+n.anchorName()+"]")}function H(e){O.splice(O.indexOf(e),1);F();n._invokeFilteredListener(e)}function B(e){O.push(e);F();n._invokeFilteredListener(e)}function j(){O=[];F();n._invokeFilteredListener(null)}function F(){if(n.dimension()&&n.dimension().filter){var e=M(n.dimension(),O);O=e?e:O}}function I(){for(var e=0;e<T.length;++e){T[e](n)}}n.__dc_flag__=t.utils.uniqueId();var r;var i;var s;var o;var u;var a=200;var f=function(e){var t=e&&e.getBoundingClientRect&&e.getBoundingClientRect().width;return t&&t>a?t:a};var l=f;var c=200;var h=function(e){var t=e&&e.getBoundingClientRect&&e.getBoundingClientRect().height;return t&&t>c?t:c};var p=h;var d=t.pluck("key");var v=t.pluck("value");var m=t.pluck("key");var g=t.pluck("key");var y;var b=false;var w=function(e){return n.keyAccessor()(e)+": "+n.valueAccessor()(e)};var E=false;var S=750;var x=t.printers.filters;var T=[];var N=["dimension","group"];var C=t.constants.DEFAULT_CHART_GROUP;var k=function(){};var L={preRender:k,postRender:k,preRedraw:k,postRedraw:k,filtered:k,zoomed:k};var A;var O=[];var M=function(e,t){e.filter(null);if(t.length===0)e.filter(null);else e.filterFunction(function(e){for(var n=0;n<t.length;n++){var r=t[n];if(r.isFiltered&&r.isFiltered(e)){return true}else if(r==e){return true}}return false});return t};var _=function(e){return e.all()};n.width=function(t){if(!arguments.length)return l(o.node());l=e.functor(t||f);return n};n.height=function(t){if(!arguments.length)return p(o.node());p=e.functor(t||h);return n};n.minWidth=function(e){if(!arguments.length)return a;a=e;return n};n.minHeight=function(e){if(!arguments.length)return c;c=e;return n};n.dimension=function(e){if(!arguments.length)return r;r=e;n.expireCache();return n};n.data=function(t){if(!arguments.length)return _.call(n,i);_=e.functor(t);n.expireCache();return n};n.group=function(e,t){if(!arguments.length)return i;i=e;n._groupName=t;n.expireCache();return n};n.ordering=function(e){if(!arguments.length)return g;g=e;y=crossfilter.quicksort.by(g);n.expireCache();return n};n._computeOrderedGroups=function(e){var t=e.slice(0);if(t.length<=1)return t;if(!y)y=crossfilter.quicksort.by(g);return y(t,0,t.length)};n.filterAll=function(){return n.filter(null)};n.select=function(e){return o.select(e)};n.selectAll=function(e){return o?o.selectAll(e):null};n.anchor=function(r,i){if(!arguments.length)return s;if(t.instanceOfChart(r)){s=r.anchor();o=r.root()}else{s=r;o=e.select(s);o.classed(t.constants.CHART_CLASS,true);t.registerChart(n,i)}C=i;return n};n.anchorName=function(){var e=n.anchor();if(e&&e.id)return e.id;if(e&&e.replace)return e.replace("#","");return""+n.chartID()};n.root=function(e){if(!arguments.length)return o;o=e;return n};n.svg=function(e){if(!arguments.length)return u;u=e;return n};n.resetSvg=function(){n.select("svg").remove();return D()};n.filterPrinter=function(e){if(!arguments.length)return x;x=e;return n};n.turnOnControls=function(){if(o){n.selectAll(".reset").style("display",null);n.selectAll(".filter").text(x(n.filters())).style("display",null)}return n};n.turnOffControls=function(){if(o){n.selectAll(".reset").style("display","none");n.selectAll(".filter").style("display","none").text(n.filter())}return n};n.transitionDuration=function(e){if(!arguments.length)return S;S=e;return n};n._mandatoryAttributes=function(e){if(!arguments.length)return N;N=e;return n};n.render=function(){L.preRender(n);if(N)N.forEach(P);var e=n._doRender();if(A)A.render();n._activateRenderlets("postRender");return e};n._activateRenderlets=function(e){if(n.transitionDuration()>0&&u){u.transition().duration(n.transitionDuration()).each("end",function(){I();if(e)L[e](n)})}else{I();if(e)L[e](n)}};n.redraw=function(){L.preRedraw(n);var e=n._doRedraw();if(A)A.render();n._activateRenderlets("postRedraw");return e};n.redrawGroup=function(){t.redrawAll(n.chartGroup())};n._invokeFilteredListener=function(e){if(e!==undefined)L.filtered(n,e)};n._invokeZoomedListener=function(){L.zoomed(n)};n.hasFilter=function(e){if(!arguments.length)return O.length>0;return O.indexOf(e)>=0};n.replaceFilter=function(e){O=[];n.filter(e)};n.filter=function(e){if(!arguments.length)return O.length>0?O[0]:null;if(e instanceof Array&&e[0]instanceof Array&&!e.isFiltered){e[0].forEach(function(e){if(n.hasFilter(e)){O.splice(O.indexOf(e),1)}else{O.push(e)}});F();n._invokeFilteredListener(e)}else if(e===null){j()}else{if(n.hasFilter(e))H(e);else B(e)}if(o!==null&&n.hasFilter()){n.turnOnControls()}else{n.turnOffControls()}return n};n.filters=function(){return O};n.highlightSelected=function(n){e.select(n).classed(t.constants.SELECTED_CLASS,true);e.select(n).classed(t.constants.DESELECTED_CLASS,false)};n.fadeDeselected=function(n){e.select(n).classed(t.constants.SELECTED_CLASS,false);e.select(n).classed(t.constants.DESELECTED_CLASS,true)};n.resetHighlight=function(n){e.select(n).classed(t.constants.SELECTED_CLASS,false);e.select(n).classed(t.constants.DESELECTED_CLASS,false)};n.onClick=function(e){var r=n.keyAccessor()(e);t.events.trigger(function(){n.filter(r);n.redrawGroup()})};n.filterHandler=function(e){if(!arguments.length)return M;M=e;return n};n._doRender=function(){return n};n._doRedraw=function(){return n};n.legendables=function(){return[]};n.legendHighlight=function(e){};n.legendReset=function(e){};n.legendToggle=function(e){};n.isLegendableHidden=function(e){return false};n.keyAccessor=function(e){if(!arguments.length)return d;d=e;return n};n.valueAccessor=function(e){if(!arguments.length)return v;v=e;return n};n.label=function(e){if(!arguments.length)return m;m=e;b=true;return n};n.renderLabel=function(e){if(!arguments.length)return b;b=e;return n};n.title=function(e){if(!arguments.length)return w;w=e;E=true;return n};n.renderTitle=function(e){if(!arguments.length)return E;E=e;return n};n.renderlet=function(e){T.push(e);return n};n.chartGroup=function(e){if(!arguments.length)return C;C=e;return n};n.expireCache=function(){return n};n.legend=function(e){if(!arguments.length)return A;A=e;A.parent(n);return n};n.chartID=function(){return n.__dc_flag__};n.options=function(e){for(var r in e){if(typeof n[r]==="function"){n[r].call(n,e[r])}else{t.logger.debug("Not a valid option setter name: "+r)}}return n};n.on=function(e,t){L[e]=t;return n};return n};t.marginMixin=function(e){var t={top:10,right:50,bottom:30,left:30};e.margins=function(n){if(!arguments.length)return t;t=n;return e};e.effectiveWidth=function(){return e.width()-e.margins().left-e.margins().right};e.effectiveHeight=function(){return e.height()-e.margins().top-e.margins().bottom};return e};t.colorMixin=function(t){var n=e.scale.category10();var r=true;var i=function(e){return t.keyAccessor()(e)};t.colors=function(e){if(!arguments.length)return n;return t};t.ordinalColors=function(n){return t.colors(e.scale.ordinal().range(n))};t.linearColors=function(n){return t.colors(e.scale.linear().range(n).interpolate(e.interpolateHcl))};t.colorAccessor=function(e){if(!arguments.length)return i;i=e;r=false;return t};t.defaultColorAccessor=function(){return r};t.colorDomain=function(e){if(!arguments.length)return n.domain();n.domain(e);return t};t.calculateColorDomain=function(){var r=[e.min(t.data(),t.colorAccessor()),e.max(t.data(),t.colorAccessor())];n.domain(r)};t.getColor=function(e,t){return n(i.call(this,e,t))};t.colorCalculator=function(e){if(!arguments.length)return t.getColor;t.getColor=e;return t};return t};t.coordinateGridMixin=function(n){function X(e){if(n.elasticX()&&!n.isOrdinal()){h.domain([n.xAxisMin(),n.xAxisMax()])}else if(n.isOrdinal()&&h.domain().length===0){h.domain(n._ordinalXDomain())}if(n.isOrdinal()){h.rangeBands([0,n.xAxisLength()],z,U)}else{h.range([0,n.xAxisLength()])}d=d.scale(n.x());V(e)}function V(e){var i=e.selectAll("g."+s);if(O){if(i.empty())i=e.insert("g",":first-child").attr("class",r+" "+s).attr("transform","translate("+n.margins().left+","+n.margins().top+")");var o=d.tickValues()?d.tickValues():h.ticks(d.ticks()[0]);var u=i.selectAll("line").data(o);var a=u.enter().append("line").attr("x1",function(e){return h(e)}).attr("y1",n._xAxisY()-n.margins().top).attr("x2",function(e){return h(e)}).attr("y2",0).attr("opacity",0);t.transition(a,n.transitionDuration()).attr("opacity",1);t.transition(u,n.transitionDuration()).attr("x1",function(e){return h(e)}).attr("y1",n._xAxisY()-n.margins().top).attr("x2",function(e){return h(e)}).attr("y2",0);u.exit().remove()}else{i.selectAll("line").remove()}}function $(){return n._xAxisY()-n.margins().top}function J(){return n.anchorName()+"-clip"}function K(){var e=t.utils.appendOrSelect(f,"defs");var r=t.utils.appendOrSelect(e,"clipPath").attr("id",J());var i=R*2;t.utils.appendOrSelect(r,"rect").attr("width",n.xAxisLength()+i).attr("height",n.yAxisHeight()+i)}function Q(e){if(n.isOrdinal())k=false;X(n.g());n._prepareYAxis(n.g());n.plotData();if(n.elasticX()||M||e)n.renderXAxis(n.g());if(n.elasticY()||e)n.renderYAxis(n.g());if(e)n.renderBrush(n.g());else n.redrawBrush(n.g())}function G(){if(q){n._enableMouseZoom()}else if(j){n._disableMouseZoom()}}function Y(){M=true;if(P){n.x().domain(Z(n.x().domain(),p));if(F){n.x().domain(Z(n.x().domain(),F.x().domain()))}}var e=n.x().domain();var r=t.filters.RangedFilter(e[0],e[1]);n.replaceFilter(r);n.rescale();n.redraw();if(F&&!et(n.filter(),F.filter())){t.events.trigger(function(){F.replaceFilter(r);F.redraw()})}n._invokeZoomedListener();t.events.trigger(function(){n.redrawGroup()},t.constants.EVENT_DELAY);M=!et(e,p)}function Z(t,n){var r=[];r[0]=e.max([t[0],n[0]]);r[1]=e.min([t[1],n[1]]);return r}function et(e,t){if(!e&&!t){return true}else if(!e||!t){return false}else if(e.length===0&&t.length===0){return true}else if(e[0].valueOf()===t[0].valueOf()&&e[1].valueOf()===t[1].valueOf()){return true}else return false}function tt(e){return e instanceof Array&&e.length>1}var r="grid-line";var i="horizontal";var s="vertical";var o="y-axis-label";var u="x-axis-label";var a=12;n=t.colorMixin(t.marginMixin(t.baseMixin(n)));n.colors(e.scale.category10());n._mandatoryAttributes().push("x");var f;var l;var c;var h;var p;var d=e.svg.axis().orient("bottom");var v=t.units.integers;var m=0;var g=false;var y;var b=0;var w;var E=e.svg.axis().orient("left");var S=0;var x=false;var T;var N=0;var C=e.svg.brush();var k=true;var L;var A=false;var O=false;var M=false;var _;var D=[1,Infinity];var P=true;var H=e.behavior.zoom().on("zoom",Y);var B=e.behavior.zoom().on("zoom",null);var j=false;var F;var I;var q=false;var R=0;var U=.5;var z=0;var W=false;n.rescale=function(){_=undefined};n.rangeChart=function(e){if(!arguments.length)return F;F=e;F.focusChart(n);return n};n.zoomScale=function(e){if(!arguments.length)return D;D=e;return n};n.zoomOutRestrict=function(e){if(!arguments.length)return P;D[0]=e?1:0;P=e;return n};n._generateG=function(e){if(e===undefined)f=n.svg();else f=e;l=f.append("g");c=l.append("g").attr("class","chart-body").attr("transform","translate("+n.margins().left+", "+n.margins().top+")").attr("clip-path","url(#"+J()+")");return l};n.g=function(e){if(!arguments.length)return l;l=e;return n};n.mouseZoomable=function(e){if(!arguments.length)return q;q=e;return n};n.chartBodyG=function(e){if(!arguments.length)return c;c=e;return n};n.x=function(e){if(!arguments.length)return h;h=e;p=h.domain();return n};n.xOriginalDomain=function(){return p};n.xUnits=function(e){if(!arguments.length)return v;v=e;return n};n.xAxis=function(e){if(!arguments.length)return d;d=e;return n};n.elasticX=function(e){if(!arguments.length)return g;g=e;return n};n.xAxisPadding=function(e){if(!arguments.length)return m;m=e;return n};n.xUnitCount=function(){if(_===undefined){var e=n.xUnits()(n.x().domain()[0],n.x().domain()[1],n.x().domain());if(e instanceof Array)_=e.length;else _=e}return _};n.useRightYAxis=function(e){if(!arguments.length)return W;W=e;return n};n.isOrdinal=function(){return n.xUnits()===t.units.ordinal};n._ordinalXDomain=function(){var e=n._computeOrderedGroups(n.data());return e.map(n.keyAccessor())};n.renderXAxis=function(e){var r=e.selectAll("g.x");if(r.empty())r=e.append("g").attr("class","axis x").attr("transform","translate("+n.margins().left+","+n._xAxisY()+")");var i=e.selectAll("text."+u);if(i.empty()&&n.xAxisLabel())i=e.append("text").attr("transform","translate("+(n.margins().left+n.xAxisLength()/2)+","+(n.height()-b)+")").attr("class",u).attr("text-anchor","middle").text(n.xAxisLabel());if(n.xAxisLabel()&&i.text()!=n.xAxisLabel())i.text(n.xAxisLabel());t.transition(r,n.transitionDuration()).call(d)};n._xAxisY=function(){return n.height()-n.margins().bottom};n.xAxisLength=function(){return n.effectiveWidth()};n.xAxisLabel=function(e,t){if(!arguments.length)return y;y=e;n.margins().bottom-=b;b=t===undefined?a:t;n.margins().bottom+=b;return n};n._prepareYAxis=function(t){if(w===undefined||n.elasticY()){w=e.scale.linear();w.domain([n.yAxisMin(),n.yAxisMax()]).rangeRound([n.yAxisHeight(),0])}w.range([n.yAxisHeight(),0]);E=E.scale(w);if(W)E.orient("right");n._renderHorizontalGridLinesForAxis(t,w,E)};n.renderYAxisLabel=function(e,t,r,i){i=i||N;var s=n.g().selectAll("text."+o+"."+e+"-label");if(s.empty()&&t){var u=n.margins().top+n.yAxisHeight()/2;s=n.g().append("text").attr("transform","translate("+i+","+u+"),rotate("+r+")").attr("class",o+" "+e+"-label").attr("text-anchor","middle").text(t)}if(t&&s.text()!=t){s.text(t)}};n.renderYAxisAt=function(e,r,i){var s=n.g().selectAll("g."+e);if(s.empty()){s=n.g().append("g").attr("class","axis "+e).attr("transform","translate("+i+","+n.margins().top+")")}t.transition(s,n.transitionDuration()).call(r)};n.renderYAxis=function(){var e=W?n.width()-n.margins().right:n._yAxisX();n.renderYAxisAt("y",E,e);var t=W?n.width()-N:N;var r=W?90:-90;n.renderYAxisLabel("y",n.yAxisLabel(),r,t)};n._renderHorizontalGridLinesForAxis=function(e,s,o){var u=e.selectAll("g."+i);if(A){var a=o.tickValues()?o.tickValues():s.ticks(o.ticks()[0]);if(u.empty()){u=e.insert("g",":first-child").attr("class",r+" "+i).attr("transform","translate("+n.margins().left+","+n.margins().top+")")}var f=u.selectAll("line").data(a);var l=f.enter().append("line").attr("x1",1).attr("y1",function(e){return s(e)}).attr("x2",n.xAxisLength()).attr("y2",function(e){return s(e)}).attr("opacity",0);t.transition(l,n.transitionDuration()).attr("opacity",1);t.transition(f,n.transitionDuration()).attr("x1",1).attr("y1",function(e){return s(e)}).attr("x2",n.xAxisLength()).attr("y2",function(e){return s(e)});f.exit().remove()}else{u.selectAll("line").remove()}};n._yAxisX=function(){return n.useRightYAxis()?n.width()-n.margins().right:n.margins().left};n.yAxisLabel=function(e,t){if(!arguments.length)return T;T=e;n.margins().left-=N;N=t===undefined?a:t;n.margins().left+=N;return n};n.y=function(e){if(!arguments.length)return w;w=e;return n};n.yAxis=function(e){if(!arguments.length)return E;E=e;return n};n.elasticY=function(e){if(!arguments.length)return x;x=e;return n};n.renderHorizontalGridLines=function(e){if(!arguments.length)return A;A=e;return n};n.renderVerticalGridLines=function(e){if(!arguments.length)return O;O=e;return n};n.xAxisMin=function(){var r=e.min(n.data(),function(e){return n.keyAccessor()(e)});return t.utils.subtract(r,m)};n.xAxisMax=function(){var r=e.max(n.data(),function(e){return n.keyAccessor()(e)});return t.utils.add(r,m)};n.yAxisMin=function(){var r=e.min(n.data(),function(e){return n.valueAccessor()(e)});return t.utils.subtract(r,S)};n.yAxisMax=function(){var r=e.max(n.data(),function(e){return n.valueAccessor()(e)});return t.utils.add(r,S)};n.yAxisPadding=function(e){if(!arguments.length)return S;S=e;return n};n.yAxisHeight=function(){return n.effectiveHeight()};n.round=function(e){if(!arguments.length)return L;L=e;return n};n._rangeBandPadding=function(e){if(!arguments.length)return z;z=e;return n};n._outerRangeBandPadding=function(e){if(!arguments.length)return U;U=e;return n};t.override(n,"filter",function(e){if(!arguments.length)return n._filter();n._filter(e);if(e){n.brush().extent(e)}else{n.brush().clear()}return n});n.brush=function(e){if(!arguments.length)return C;C=e;return n};n.renderBrush=function(e){if(k){C.on("brush",n._brushing);C.on("brushstart",n._disableMouseZoom);C.on("brushend",G);var t=e.append("g").attr("class","brush").attr("transform","translate("+n.margins().left+","+n.margins().top+")").call(C.x(n.x()));n.setBrushY(t);n.setHandlePaths(t);if(n.hasFilter()){n.redrawBrush(e)}}};n.setHandlePaths=function(e){e.selectAll(".resize").append("path").attr("d",n.resizeHandlePath)};n.setBrushY=function(e){e.selectAll("rect").attr("height",$())};n.extendBrush=function(){var e=C.extent();if(n.round()){e[0]=e.map(n.round())[0];e[1]=e.map(n.round())[1];l.select(".brush").call(C.extent(e))}return e};n.brushIsEmpty=function(e){return C.empty()||!e||e[1]<=e[0]};n._brushing=function(){var e=n.extendBrush();n.redrawBrush(l);if(n.brushIsEmpty(e)){t.events.trigger(function(){n.filter(null);n.redrawGroup()},t.constants.EVENT_DELAY)}else{var r=t.filters.RangedFilter(e[0],e[1]);t.events.trigger(function(){n.replaceFilter(r);n.redrawGroup()},t.constants.EVENT_DELAY)}};n.redrawBrush=function(e){if(k){if(n.filter()&&n.brush().empty())n.brush().extent(n.filter());var t=e.select("g.brush");t.call(n.brush().x(n.x()));n.setBrushY(t)}n.fadeDeselectedArea()};n.fadeDeselectedArea=function(){};n.resizeHandlePath=function(e){var t=+(e=="e"),n=t?1:-1,r=$()/3;return"M"+.5*n+","+r+"A6,6 0 0 "+t+" "+6.5*n+","+(r+6)+"V"+(2*r-6)+"A6,6 0 0 "+t+" "+.5*n+","+2*r+"Z"+"M"+2.5*n+","+(r+8)+"V"+(2*r-8)+"M"+4.5*n+","+(r+8)+"V"+(2*r-8)};n.clipPadding=function(e){if(!arguments.length)return R;R=e;return n};n._preprocessData=function(){};n._doRender=function(){n.resetSvg();n._preprocessData();n._generateG();K();Q(true);G();return n};n._doRedraw=function(){n._preprocessData();Q(false);return n};n._enableMouseZoom=function(){j=true;H.x(n.x()).scaleExtent(D).size([n.width(),n.height()]);n.root().call(H)};n._disableMouseZoom=function(){n.root().call(B)};n.focus=function(e){if(tt(e))n.x().domain(e);else n.x().domain(p);H.x(n.x());Y()};n.refocused=function(){return M};n.focusChart=function(e){if(!arguments.length)return I;I=e;n.on("filtered",function(e){if(!e.filter()){t.events.trigger(function(){I.x().domain(I.xOriginalDomain())})}else if(!et(e.filter(),I.filter())){t.events.trigger(function(){I.focus(e.filter())})}});return n};n.brushOn=function(e){if(!arguments.length)return k;k=e;return n};return n};t.stackMixin=function(n){function u(e,t){var r=e.accessor||n.valueAccessor();e.name=String(e.name||t);e.values=e.group.all().map(function(t,i){return{x:n.keyAccessor()(t,i),y:e.hidden?null:r(t,i),data:t,layer:e.name,hidden:e.hidden}});e.values=e.values.filter(a());return e.values}function a(){if(!n.x())return e.functor(true);var t=n.x().domain();if(n.isOrdinal()){return function(e){return true}}return function(e){return e.x>=t[0]&&e.x<=t[t.length-1]}}function f(e){var n=i.map(t.pluck("name")).indexOf(e);return i[n]}function l(){return n.data().reduce(function(e,t){return e.concat(t.values)},[])}function c(e){return!e.hidden}var r=e.layout.stack().values(u);var i=[];var s={};var o=false;n.stack=function(e,t,r){if(!arguments.length)return i;if(arguments.length<=2)r=t;var s={group:e};if(typeof t==="string")s.name=t;if(typeof r==="function")s.accessor=r;i.push(s);return n};t.override(n,"group",function(e,t,r){if(!arguments.length)return n._group();i=[];s={};n.stack(e,t);if(r)n.valueAccessor(r);return n._group(e,t)});n.hidableStacks=function(e){if(!arguments.length)return o;o=e;return n};n.hideStack=function(e){var t=f(e);if(t)t.hidden=true;return n};n.showStack=function(e){var t=f(e);if(t)t.hidden=false;return n};n.getValueAccessorByIndex=function(e){return i[e].accessor||n.valueAccessor()};n.yAxisMin=function(){var r=e.min(l(),function(e){return e.y+e.y0<e.y0?e.y+e.y0:e.y0});return t.utils.subtract(r,n.yAxisPadding())};n.yAxisMax=function(){var r=e.max(l(),function(e){return e.y+e.y0});return t.utils.add(r,n.yAxisPadding())};n.xAxisMin=function(){var r=e.min(l(),t.pluck("x"));return t.utils.subtract(r,n.xAxisPadding())};n.xAxisMax=function(){var r=e.max(l(),t.pluck("x"));return t.utils.add(r,n.xAxisPadding())};t.override(n,"title",function(e,t){if(!e)return n._title();if(typeof e==="function")return n._title(e);if(e==n._groupName&&typeof t==="function")return n._title(t);if(typeof t!=="function")return s[e]||n._title();s[e]=t;return n});n.stackLayout=function(e){if(!arguments.length)return r;r=e;return n};n.data(function(){var e=i.filter(c);return e.length?n.stackLayout()(e):[]});n._ordinalXDomain=function(){return l().map(t.pluck("x"))};n.colorAccessor(function(e){var t=this.layer||this.name||e.name||e.layer;return t});n.legendables=function(){return i.map(function(e,t){return{chart:n,name:e.name,hidden:e.hidden||false,color:n.getColor.call(e,e.values,t)}})};n.isLegendableHidden=function(e){var t=f(e.name);return t?t.hidden:false};n.legendToggle=function(e){if(o){if(n.isLegendableHidden(e))n.showStack(e.name);else n.hideStack(e.name);t.renderAll(n.chartGroup())}};return n};t.capMixin=function(n){var r=Infinity;var i="Others";var s=function(t){var r=e.sum(t,n.valueAccessor()),s=n.group().all(),o=e.sum(s,n.valueAccessor()),u=t.map(n.keyAccessor()),a=s.map(n.keyAccessor()),f=e.set(u),l=a.filter(function(e){return!f.has(e)});if(o>r)return t.concat([{others:l,key:i,value:o-r}]);return t};n.cappedKeyAccessor=function(e,t){if(e.others)return e.key;return n.keyAccessor()(e,t)};n.cappedValueAccessor=function(e,t){if(e.others)return e.value;return n.valueAccessor()(e,t)};n.data(function(e){if(r==Infinity){return n._computeOrderedGroups(e.all())}else{var t=e.top(r);t=n._computeOrderedGroups(t);if(s)return s(t);return t}});n.cap=function(e){if(!arguments.length)return r;r=e;return n};n.othersLabel=function(e){if(!arguments.length)return i;i=e;return n};n.othersGrouper=function(e){if(!arguments.length)return s;s=e;return n};t.override(n,"onClick",function(e){if(e.others)n.filter([e.others]);n._onClick(e)});return n};t.bubbleMixin=function(n){var r=.3;var i=10;n.BUBBLE_NODE_CLASS="node";n.BUBBLE_CLASS="bubble";n.MIN_RADIUS=10;n=t.colorMixin(n);n.renderLabel(true);n.renderTitle(false);n.data(function(e){return e.top(Infinity)});var s=e.scale.linear().domain([0,100]);var o=function(e){return e.r};n.r=function(e){if(!arguments.length)return s;s=e;return n};n.radiusValueAccessor=function(e){if(!arguments.length)return o;o=e;return n};n.rMin=function(){var t=e.min(n.data(),function(e){return n.radiusValueAccessor()(e)});return t};n.rMax=function(){var t=e.max(n.data(),function(e){return n.radiusValueAccessor()(e)});return t};n.bubbleR=function(e){var t=n.radiusValueAccessor()(e);var r=n.r()(t);if(isNaN(r)||t<=0)r=0;return r};var u=function(e){return n.label()(e)};var a=function(e){return n.bubbleR(e)>i?1:0};n._doRenderLabel=function(e){if(n.renderLabel()){var r=e.select("text");if(r.empty()){r=e.append("text").attr("text-anchor","middle").attr("dy",".3em").on("click",n.onClick)}r.attr("opacity",0).text(u);t.transition(r,n.transitionDuration()).attr("opacity",a)}};n.doUpdateLabels=function(e){if(n.renderLabel()){var r=e.selectAll("text").text(u);t.transition(r,n.transitionDuration()).attr("opacity",a)}};var f=function(e){return n.title()(e)};n._doRenderTitles=function(e){if(n.renderTitle()){var t=e.select("title");if(t.empty())e.append("title").text(f)}};n.doUpdateTitles=function(e){if(n.renderTitle()){e.selectAll("title").text(f)}};n.minRadiusWithLabel=function(e){if(!arguments.length)return i;i=e;return n};n.maxBubbleRelativeSize=function(e){if(!arguments.length)return r;r=e;return n};n.fadeDeselectedArea=function(){if(n.hasFilter()){n.selectAll("g."+n.BUBBLE_NODE_CLASS).each(function(e){if(n.isSelectedNode(e)){n.highlightSelected(this)}else{n.fadeDeselected(this)}})}else{n.selectAll("g."+n.BUBBLE_NODE_CLASS).each(function(e){n.resetHighlight(this)})}};n.isSelectedNode=function(e){return n.hasFilter(e.key)};n.onClick=function(e){var r=e.key;t.events.trigger(function(){n.filter(r);t.redrawAll(n.chartGroup())})};return n};t.pieChart=function(n,r){function h(){o=o?o:e.min([c.width(),c.height()])/2;var t=N();var n=k();var r=n(c.data());if(a){var i=a.selectAll("g."+s).data(r);p(i,t,r);b(r,t);x(i);T()}}function p(e,t,n){var r=d(e);v(r,t);m(r);y(n,t)}function d(e){var t=e.enter().append("g").attr("class",function(e,t){return s+" _"+t});return t}function v(e,n){var r=e.append("path").attr("fill",_).on("click",D).attr("d",function(e,t){return P(e,t,n)});t.transition(r,c.transitionDuration(),function(e){e.attrTween("d",O)})}function m(e){if(c.renderTitle()){e.append("title").text(function(e){return c.title()(e)})}}function g(e,n){t.transition(e,c.transitionDuration()).attr("transform",function(e){return H(e,n)}).attr("text-anchor","middle").text(function(e){var t=e.data;if(A(t)||L(e))return"";return c.label()(e.data)})}function y(e,t){if(c.renderLabel()){var n=a.selectAll("text."+s).data(e);n.exit().remove();var r=n.enter().append("text").attr("class",function(e,t){var n=s+" _"+t;if(l)n+=" external";return n}).on("click",D);g(r,t)}}function b(e,t){w(e,t);E(e,t);S(e)}function w(e,n){var r=a.selectAll("g."+s).data(e).select("path").attr("d",function(e,t){return P(e,t,n)});t.transition(r,c.transitionDuration(),function(e){e.attrTween("d",O)}).attr("fill",_)}function E(e,t){if(c.renderLabel()){var n=a.selectAll("text."+s).data(e);g(n,t)}}function S(e){if(c.renderTitle()){a.selectAll("g."+s).data(e).select("title").text(function(e){return c.title()(e.data)})}}function x(e){e.exit().remove()}function T(){if(c.hasFilter()){c.selectAll("g."+s).each(function(e){if(C(e)){c.highlightSelected(this)}else{c.fadeDeselected(this)}})}else{c.selectAll("g."+s).each(function(e){c.resetHighlight(this)})}}function N(){return e.svg.arc().outerRadius(o).innerRadius(u)}function C(e){return c.hasFilter(c.cappedKeyAccessor(e.data))}function k(){return e.layout.pie().sort(null).value(c.cappedValueAccessor)}function L(e){var t=e.endAngle-e.startAngle;return isNaN(t)||t<f}function A(e){return c.cappedValueAccessor(e)===0}function O(t){t.innerRadius=u;var n=this._current;if(M(n))n={startAngle:0,endAngle:0};var r=e.interpolate(n,t);this._current=r(0);return function(e){return P(r(e),0,N())}}function M(e){return!e||isNaN(e.startAngle)||isNaN(e.endAngle)}function _(e,t){return c.getColor(e.data,t)}function D(e,t){c.onClick(e.data,t)}function P(e,t,n){var r=n(e,t);if(r.indexOf("NaN")>=0)r="M0,0";return r}function H(t,n){var r;if(l){r=e.svg.arc().outerRadius(o+l).innerRadius(o+l).centroid(t)}else{r=n.centroid(t)}if(isNaN(r[0])||isNaN(r[1])){return"translate(0,0)"}else{return"translate("+r+")"}}function B(t,n){c.selectAll("g.pie-slice").each(function(r){if(t.name==r.data.key){e.select(this).classed("highlight",n)}})}var i=.5;var s="pie-slice";var o,u=0;var a;var f=i;var l;var c=t.capMixin(t.colorMixin(t.baseMixin({})));c.colorAccessor(c.cappedKeyAccessor);c.title(function(e){return c.cappedKeyAccessor(e)+": "+c.cappedValueAccessor(e)});c.slicesCap=c.cap;c.label(c.cappedKeyAccessor);c.renderLabel(true);c.transitionDuration(350);c._doRender=function(){c.resetSvg();a=c.svg().append("g").attr("transform","translate("+c.cx()+","+c.cy()+")");h();return c};c.innerRadius=function(e){if(!arguments.length)return u;u=e;return c};c.radius=function(e){if(!arguments.length)return o;o=e;return c};c.cx=function(){return c.width()/2};c.cy=function(){return c.height()/2};c._doRedraw=function(){h();return c};c.minAngleForLabel=function(e){if(!arguments.length)return f;f=e;return c};c.externalLabels=function(e){if(arguments.length===0){return l}else if(e){l=e}else{l=undefined}return c};c.legendables=function(){return c.data().map(function(e,t){var n={name:e.key,data:e.value,others:e.others,chart:c};n.color=c.getColor(e,t);return n})};c.legendHighlight=function(e){B(e,true)};c.legendReset=function(e){B(e,false)};c.legendToggle=function(e){c.onClick({key:e.name,others:e.others})};return c.anchor(n,r)};t.barChart=function(n,r){function c(e){return t.utils.safeNumber(Math.abs(o.y()(e.y+e.y0)-o.y()(e.y0)))}function h(e,n,r){var i=e.selectAll("rect.bar").data(r.values,t.pluck("x"));i.enter().append("rect").attr("class","bar").attr("fill",t.pluck("data",o.getColor)).attr("height",0);if(o.renderTitle())i.append("title").text(t.pluck("data",o.title(r.name)));if(o.isOrdinal())i.on("click",d);t.transition(i,o.transitionDuration()).attr("x",function(e){var n=o.x()(e.x);if(a)n-=l/2;if(o.isOrdinal())n+=u/2;return t.utils.safeNumber(n)}).attr("y",function(e){var n=o.y()(e.y+e.y0);if(e.y<0)n-=c(e);return t.utils.safeNumber(n)}).attr("width",l).attr("height",function(e){return c(e)}).attr("fill",t.pluck("data",o.getColor)).select("title").text(t.pluck("data",o.title(r.name)));t.transition(i.exit(),o.transitionDuration()).attr("height",0).remove()}function p(){if(l===undefined){var e=o.xUnitCount();if(o.isOrdinal()&&!u)l=Math.floor(o.x().rangeBand());else if(u)l=Math.floor((o.xAxisLength()-(e-1)*u)/e);else l=Math.floor(o.xAxisLength()/(1+o.barPadding())/e);if(l==Infinity||isNaN(l)||l<i)l=i}}function d(e){o.onClick(e.data)}function v(t,n){return function(){var r=e.select(this);var i=r.attr("fill")==t;return n?!i:i}}var i=1;var s=2;var o=t.stackMixin(t.coordinateGridMixin({}));var u=s;var a=false;var f=false;var l;t.override(o,"rescale",function(){o._rescale();l=undefined});t.override(o,"render",function(){if(o.round()&&a&&!f){t.logger.warn("By default, brush rounding is disabled if bars are centered. "+"See dc.js bar chart API documentation for details.")}o._render()});o.plotData=function(){var t=o.chartBodyG().selectAll("g.stack").data(o.data());p();t.enter().append("g").attr("class",function(e,t){return"stack "+"_"+t});t.each(function(t,n){var r=e.select(this);h(r,n,t)})};o.fadeDeselectedArea=function(){var e=o.chartBodyG().selectAll("rect.bar");var n=o.brush().extent();if(o.isOrdinal()){if(o.hasFilter()){e.classed(t.constants.SELECTED_CLASS,function(e){return o.hasFilter(e.x)});e.classed(t.constants.DESELECTED_CLASS,function(e){return!o.hasFilter(e.x)})}else{e.classed(t.constants.SELECTED_CLASS,false);e.classed(t.constants.DESELECTED_CLASS,false)}}else{if(!o.brushIsEmpty(n)){var r=n[0];var i=n[1];e.classed(t.constants.DESELECTED_CLASS,function(e){return e.x<r||e.x>=i})}else{e.classed(t.constants.DESELECTED_CLASS,false)}}};o.centerBar=function(e){if(!arguments.length)return a;a=e;return o};o.barPadding=function(e){if(!arguments.length)return o._rangeBandPadding();o._rangeBandPadding(e);u=0;return o};o.outerPadding=o._outerRangeBandPadding;o.gap=function(e){if(!arguments.length)return u;u=e;return o};o.extendBrush=function(){var e=o.brush().extent();if(o.round()&&(!a||f)){e[0]=e.map(o.round())[0];e[1]=e.map(o.round())[1];o.chartBodyG().select(".brush").call(o.brush().extent(e))}return e};o.alwaysUseRounding=function(e){if(!arguments.length)return f;f=e;return o};o.legendHighlight=function(e){if(!o.isLegendableHidden(e)){o.g().selectAll("rect.bar").classed("highlight",v(e.color)).classed("fadeout",v(e.color,true))}};o.legendReset=function(){o.g().selectAll("rect.bar").classed("highlight",false).classed("fadeout",false)};t.override(o,"xAxisMax",function(){var e=this._xAxisMax();if("resolution"in o.xUnits()){var t=o.xUnits().resolution;e+=t}return e});return o.anchor(n,r)};t.lineChart=function(n,r){function w(e,t){return l.getColor.call(e,e.values,t)}function E(n,r){var i=e.svg.line().x(function(e){return l.x()(e.x)}).y(function(e){return l.y()(e.y+e.y0)}).interpolate(m).tension(g);if(y)i.defined(y);var s=n.append("path").attr("class","line").attr("stroke",w);if(b)s.attr("stroke-dasharray",b);t.transition(r.select("path.line"),l.transitionDuration()).attr("stroke",w).attr("d",function(e){return x(i(e.values))})}function S(n,r){if(c){var i=e.svg.area().x(function(e){return l.x()(e.x)}).y(function(e){return l.y()(e.y+e.y0)}).y0(function(e){return l.y()(e.y0)}).interpolate(m).tension(g);if(y)i.defined(y);n.append("path").attr("class","area").attr("fill",w).attr("d",function(e){return x(i(e.values))});t.transition(r.select("path.area"),l.transitionDuration()).attr("fill",w).attr("d",function(e){return x(i(e.values))})}}function x(e){return!e||e.indexOf("NaN")>=0?"M0,0":e}function T(n,r){if(!l.brushOn()){var i=s+"-list";var u=n.select("g."+i);if(u.empty())u=n.append("g").attr("class",i);r.each(function(n,r){var i=n.values;if(y)i=i.filter(y);var a=u.select("g."+s+"._"+r);if(a.empty())a=u.append("g").attr("class",s+" _"+r);N(a);var f=a.selectAll("circle."+o).data(i,t.pluck("x"));f.enter().append("circle").attr("class",o).attr("r",L()).attr("fill",l.getColor).style("fill-opacity",d).style("stroke-opacity",v).on("mousemove",function(t){var n=e.select(this);C(n);k(n,a)}).on("mouseout",function(t){var n=e.select(this);A(n);O(a)}).append("title").text(t.pluck("data",l.title(n.name)));f.attr("cx",function(e){return t.utils.safeNumber(l.x()(e.x))}).attr("cy",function(e){return t.utils.safeNumber(l.y()(e.y+e.y0))}).attr("fill",l.getColor).select("title").text(t.pluck("data",l.title(n.name)));f.exit().remove()})}}function N(e){var t=e.select("path."+u).empty()?e.append("path").attr("class",u):e.select("path."+u);t.style("display","none").attr("stroke-dasharray","5,5");var n=e.select("path."+a).empty()?e.append("path").attr("class",a):e.select("path."+a);n.style("display","none").attr("stroke-dasharray","5,5")}function C(e){e.style("fill-opacity",.8);e.style("stroke-opacity",.8);e.attr("r",h);return e}function k(e,t){var n=e.attr("cx");var r=e.attr("cy");var i=l._yAxisX()-l.margins().left;var s="M"+i+" "+r+"L"+n+" "+r;var o="M"+n+" "+l.yAxisHeight()+"L"+n+" "+r;t.select("path."+u).style("display","").attr("d",s);t.select("path."+a).style("display","").attr("d",o)}function L(){return p||h}function A(e){e.style("fill-opacity",d).style("stroke-opacity",v).attr("r",L())}function O(e){e.select("path."+u).style("display","none");e.select("path."+a).style("display","none")}function M(t,n,r){return function(){var i=e.select(this);var s=i.attr("stroke")==t&&i.attr("stroke-dasharray")==(n instanceof Array?n.join(","):null)||i.attr("fill")==t;return r?!s:s}}var i=5;var s="dc-tooltip";var o="dot";var u="yRef";var a="xRef";var f=1e-6;var l=t.stackMixin(t.coordinateGridMixin({}));var c=false;var h=i;var p=null;var d=f;var v=f;var m="linear";var g=.7;var y;var b;l.transitionDuration(500);l._rangeBandPadding(1);l.plotData=function(){var e=l.chartBodyG();var t=e.selectAll("g.stack-list");if(t.empty())t=e.append("g").attr("class","stack-list");var n=t.selectAll("g.stack").data(l.data());var r=n.enter().append("g").attr("class",function(e,t){return"stack "+"_"+t});E(r,n);S(r,n);T(e,n)};l.interpolate=function(e){if(!arguments.length)return m;m=e;return l};l.tension=function(e){if(!arguments.length)return g;g=e;return l};l.defined=function(e){if(!arguments.length)return y;y=e;return l};l.dashStyle=function(e){if(!arguments.length)return b;b=e;return l};l.renderArea=function(e){if(!arguments.length)return c;c=e;return l};l.dotRadius=function(e){if(!arguments.length)return h;h=e;return l};l.renderDataPoints=function(e){if(!arguments.length){return{fillOpacity:d,strokeOpacity:v,radius:p}}else if(!e){d=f;v=f;p=null}else{d=e.fillOpacity||.8;v=e.strokeOpacity||.8;p=e.radius||2}return l};l.legendHighlight=function(e){if(!l.isLegendableHidden(e)){l.g().selectAll("path.line, path.area").classed("highlight",M(e.color,e.dashstyle)).classed("fadeout",M(e.color,e.dashstyle,true))}};l.legendReset=function(){l.g().selectAll("path.line, path.area").classed("highlight",false).classed("fadeout",false)};t.override(l,"legendables",function(){var e=l._legendables();if(!b)return e;return e.map(function(e){e.dashstyle=b;return e})});return l.anchor(n,r)};t.dataCount=function(n,r){var i=e.format(",d");var s=t.baseMixin({});s._doRender=function(){s.selectAll(".total-count").text(i(s.dimension().size()));s.selectAll(".filter-count").text(i(s.group().value()));return s};s._doRedraw=function(){return s._doRender()};return s.anchor(n,r)};t.dataTable=function(n,r){function p(){var e=a.root().selectAll("tbody").data(d(),function(e){return a.keyAccessor()(e)});var t=e.enter().append("tbody");t.append("tr").attr("class",u).append("td").attr("class",i).attr("colspan",l.length).html(function(e){return a.keyAccessor()(e)});e.exit().remove();return t}function d(){var t=a.dimension().top(f);return e.nest().key(a.group()).sortKeys(h).entries(t.sort(function(e,t){return h(c(e),c(t))}))}function v(e){var t=e.order().selectAll("tr."+s).data(function(e){return e.values});var n=t.enter().append("tr").attr("class",s);l.forEach(function(e,t){n.append("td").attr("class",o+" _"+t).html(e)});t.exit().remove();return t}var i="dc-table-label";var s="dc-table-row";var o="dc-table-column";var u="dc-table-group";var a=t.baseMixin({});var f=25;var l=[];var c=function(e){return e};var h=e.ascending;a._doRender=function(){a.selectAll("tbody").remove();v(p());return a};a._doRedraw=function(){return a._doRender()};a.size=function(e){if(!arguments.length)return f;f=e;return a};a.columns=function(e){if(!arguments.length)return l;l=e;return a};a.sortBy=function(e){if(!arguments.length)return c;c=e;return a};a.order=function(e){if(!arguments.length)return h;h=e;return a};return a.anchor(n,r)};t.dataGrid=function(n,r){function d(){var e=a.root().selectAll("div."+u).data(v(),function(e){return a.keyAccessor()(e)});var t=e.enter().append("div").attr("class",u);if(p){t.html(function(e){return p(e)})}e.exit().remove();return t}function v(){var t=a.dimension().top(f);return e.nest().key(a.group()).sortKeys(h).entries(t.sort(function(e,t){return h(c(e),c(t))}))}function m(e){var t=e.order().selectAll("div."+s).data(function(e){return e.values});t.enter().append("div").attr("class",s).html(function(e){return l(e)});t.exit().remove();return t}var i="dc-grid-label";var s="dc-grid-item";var o="dc-grid-group";var u="dc-grid-top";var a=t.baseMixin({});var f=999;var l=function(e){return"you need to provide an html() handling param:  "+JSON.stringify(e)};var c=function(e){return e};var h=e.ascending;var p=function(e){return"<div class='"+o+"'><h1 class='"+i+"'>"+a.keyAccessor()(e)+"</h1></div>"};a._doRender=function(){a.selectAll("div."+u).remove();m(d());return a};a._doRedraw=function(){return a._doRender()};a.size=function(e){if(!arguments.length)return f;f=e;return a};a.html=function(e){if(!arguments.length)return l;l=e;return a};a.htmlGroup=function(e){if(!arguments.length)return p;p=e;return a};a.sortBy=function(e){if(!arguments.length)return c;c=e;return a};a.order=function(e){if(!arguments.length)return h;h=e;return a};return a.anchor(n,r)};t.bubbleChart=function(e,n){function o(e){var n=e.enter().append("g");n.attr("class",r.BUBBLE_NODE_CLASS).attr("transform",s).append("circle").attr("class",function(e,t){return r.BUBBLE_CLASS+" _"+t}).on("click",r.onClick).attr("fill",r.getColor).attr("r",0);t.transition(e,r.transitionDuration()).selectAll("circle."+r.BUBBLE_CLASS).attr("r",function(e){return r.bubbleR(e)}).attr("opacity",function(e){return r.bubbleR(e)>0?1:0});r._doRenderLabel(n);r._doRenderTitles(n)}function u(e){t.transition(e,r.transitionDuration()).attr("transform",s).selectAll("circle."+r.BUBBLE_CLASS).attr("fill",r.getColor).attr("r",function(e){return r.bubbleR(e)}).attr("opacity",function(e){return r.bubbleR(e)>0?1:0});r.doUpdateLabels(e);r.doUpdateTitles(e)}function a(e){e.exit().remove()}function f(e){var t=r.x()(r.keyAccessor()(e));if(isNaN(t))t=0;return t}function l(e){var t=r.y()(r.valueAccessor()(e));if(isNaN(t))t=0;return t}var r=t.bubbleMixin(t.coordinateGridMixin({}));var i=false;r.transitionDuration(750);var s=function(e){return"translate("+f(e)+","+l(e)+")"};r.elasticRadius=function(e){if(!arguments.length)return i;i=e;return r};r.plotData=function(){if(i)r.r().domain([r.rMin(),r.rMax()]);r.r().range([r.MIN_RADIUS,r.xAxisLength()*r.maxBubbleRelativeSize()]);var e=r.chartBodyG().selectAll("g."+r.BUBBLE_NODE_CLASS).data(r.data(),function(e){return e.key});o(e);u(e);a(e);r.fadeDeselectedArea()};r.renderBrush=function(e){};r.redrawBrush=function(e){r.fadeDeselectedArea()};return r.anchor(e,n)};t.compositeChart=function(n,r){function m(){if(o.rightY()===undefined||o.elasticY()){o.rightY(e.scale.linear());o.rightY().domain([x(),C()]).rangeRound([o.yAxisHeight(),0])}o.rightY().range([o.yAxisHeight(),0]);o.rightYAxis(o.rightYAxis().scale(o.rightY()));o.rightYAxis().orient("right")}function g(){if(o.y()===undefined||o.elasticY()){o.y(e.scale.linear());o.y().domain([S(),N()]).rangeRound([o.yAxisHeight(),0])}o.y().range([o.yAxisHeight(),0]);o.yAxis(o.yAxis().scale(o.y()));o.yAxis().orient("left")}function y(e,t){e._generateG(o.g());e.g().attr("class",i+" _"+t)}function b(){return u.filter(function(e){return!e.useRightYAxis()})}function w(){return u.filter(function(e){return e.useRightYAxis()})}function E(e){return e.map(function(e){return e.yAxisMin()})}function S(){return e.min(E(b()))}function x(){return e.min(E(w()))}function T(e){return e.map(function(e){return e.yAxisMax()})}function N(){return t.utils.add(e.max(T(b())),o.yAxisPadding())}function C(){return t.utils.add(e.max(T(w())),o.yAxisPadding())}function k(){return u.map(function(e){return e.xAxisMin()})}function L(){return u.map(function(e){return e.xAxisMax()})}var i="sub";var s=12;var o=t.coordinateGridMixin({});var u=[];var a={};var f=false,l=true;var c=e.svg.axis(),h=0,p=s,d,v=false;o._mandatoryAttributes([]);o.transitionDuration(500);t.override(o,"_generateG",function(){var e=this.__generateG();for(var t=0;t<u.length;++t){var n=u[t];y(n,t);if(!n.dimension())n.dimension(o.dimension());if(!n.group())n.group(o.group());n.chartGroup(o.chartGroup());n.svg(o.svg());n.xUnits(o.xUnits());n.transitionDuration(o.transitionDuration());n.brushOn(o.brushOn())}return e});o._brushing=function(){var e=o.extendBrush();var t=o.brushIsEmpty(e);for(var n=0;n<u.length;++n){u[n].filter(null);if(!t)u[n].filter(e)}};o._prepareYAxis=function(){if(b().length!==0){g()}if(w().length!==0){m()}if(b().length>0&&!v){o._renderHorizontalGridLinesForAxis(o.g(),o.y(),o.yAxis())}else if(w().length>0){o._renderHorizontalGridLinesForAxis(o.g(),d,c)}};o.renderYAxis=function(){if(b().length!==0){o.renderYAxisAt("y",o.yAxis(),o.margins().left);o.renderYAxisLabel("y",o.yAxisLabel(),-90)}if(w().length!==0){o.renderYAxisAt("yr",o.rightYAxis(),o.width()-o.margins().right);o.renderYAxisLabel("yr",o.rightYAxisLabel(),90,o.width()-p)}};o.plotData=function(){for(var e=0;e<u.length;++e){var t=u[e];if(!t.g()){y(t,e)}if(f){t.colors(o.colors())}t.x(o.x());t.xAxis(o.xAxis());if(t.useRightYAxis()){t.y(o.rightY());t.yAxis(o.rightYAxis())}else{t.y(o.y());t.yAxis(o.yAxis())}t.plotData();t._activateRenderlets()}};o.useRightAxisGridLines=function(e){if(!arguments)return v;v=e;return o};o.childOptions=function(e){if(!arguments.length)return a;a=e;u.forEach(function(e){e.options(a)});return o};o.fadeDeselectedArea=function(){for(var e=0;e<u.length;++e){var t=u[e];t.brush(o.brush());t.fadeDeselectedArea()}};o.rightYAxisLabel=function(e,t){if(!arguments.length)return h;h=e;o.margins().right-=p;p=t===undefined?s:t;o.margins().right+=p;return o};o.compose=function(e){u=e;u.forEach(function(e){e.height(o.height());e.width(o.width());e.margins(o.margins());if(l)e.title(o.title());e.options(a)});return o};o.children=function(){return u};o.shareColors=function(e){if(!arguments.length)return f;f=e;return o};o.shareTitle=function(e){if(!arguments.length)return l;l=e;return o};o.rightY=function(e){if(!arguments.length)return d;d=e;return o};delete o.yAxisMin;delete o.yAxisMax;t.override(o,"xAxisMin",function(){return t.utils.subtract(e.min(k()),o.xAxisPadding())});t.override(o,"xAxisMax",function(){return t.utils.add(e.max(L()),o.xAxisPadding())});o.legendables=function(){return u.reduce(function(e,t){if(f)t.colors(o.colors());e.push.apply(e,t.legendables());return e},[])};o.legendHighlight=function(e){for(var t=0;t<u.length;++t){var n=u[t];n.legendHighlight(e)}};o.legendReset=function(e){for(var t=0;t<u.length;++t){var n=u[t];n.legendReset(e)}};o.legendToggle=function(e){for(var t=0;t<u.length;++t){var n=u[t];if(e.name==n._groupName)n.legendToggle(e)}};o.rightYAxis=function(e){if(!arguments.length)return c;c=e;return o};return o.anchor(n,r)};t.seriesChart=function(n,r){function l(t,n){return e.ascending(i.keyAccessor()(t),i.keyAccessor()(n))}function c(e){if(s[e].g())s[e].g().remove();delete s[e]}function h(){Object.keys(s).map(c);s={}}var i=t.compositeChart(n,r);var s={};var o=t.lineChart;var u;var a=e.ascending;var f=l;i._mandatoryAttributes().push("seriesAccessor","chart");i.shareColors(true);i._preprocessData=function(){var t=[];var n;var l=e.nest().key(u);if(a)l.sortKeys(a);if(f)l.sortValues(f);var h=l.entries(i.data());var p=h.map(function(u,a){var f=s[u.key]||o.call(i,i,r,u.key,a);if(!s[u.key])n=true;s[u.key]=f;t.push(u.key);return f.dimension(i.dimension()).group({all:e.functor(u.values)},u.key).keyAccessor(i.keyAccessor()).valueAccessor(i.valueAccessor())});Object.keys(s).filter(function(e){return t.indexOf(e)===-1}).forEach(function(e){c(e);n=true});i._compose(p);if(n&&i.legend())i.legend().render()};i.chart=function(e){if(!arguments.length)return o;o=e;h();return i};i.seriesAccessor=function(e){if(!arguments.length)return u;u=e;h();return i};i.seriesSort=function(e){if(!arguments.length)return a;a=e;h();return i};i.valueSort=function(e){if(!arguments.length)return f;f=e;h();return i};i._compose=i.compose;delete i.compose;return i};t.geoChoroplethChart=function(n,r){function a(e){var t=f();if(l(e)){var n=c(e);g(n,e,t);y(n,e,t)}}function f(){var e={};var t=i.data();for(var n=0;n<t.length;++n){e[i.keyAccessor()(t[n])]=i.valueAccessor()(t[n])}return e}function l(e){return m(e).keyAccessor}function c(e){var n=i.svg().selectAll(h(e)).classed("selected",function(t){return p(e,t)}).classed("deselected",function(t){return d(e,t)}).attr("class",function(n){var r=m(e).name;var i=t.utils.nameToId(m(e).keyAccessor(n));var s=r+" "+i;if(p(e,n))s+=" selected";if(d(e,n))s+=" deselected";return s});return n}function h(e){return"g.layer"+e+" g."+m(e).name}function p(e,t){return i.hasFilter()&&i.hasFilter(v(e,t))}function d(e,t){return i.hasFilter()&&!i.hasFilter(v(e,t))}function v(e,t){return m(e).keyAccessor(t)}function m(e){return u[e]}function g(n,r,s){var o=n.select("path").attr("fill",function(){var t=e.select(this).attr("fill");if(t)return t;return"none"}).on("click",function(e){return i.onClick(e,r)});t.transition(o,i.transitionDuration()).attr("fill",function(e,t){return i.getColor(s[m(r).keyAccessor(e)],t)})}function y(e,t,n){if(i.renderTitle()){e.selectAll("title").text(function(e){var r=v(t,e);var s=n[r];return i.title()({key:r,value:s})})}}var i=t.colorMixin(t.baseMixin({}));i.colorAccessor(function(e){return e||0});var s=e.geo.path();var o;var u=[];i._doRender=function(){i.resetSvg();for(var e=0;e<u.length;++e){var t=i.svg().append("g").attr("class","layer"+e);var n=t.selectAll("g."+m(e).name).data(m(e).data).enter().append("g").attr("class",m(e).name);n.append("path").attr("fill","white").attr("d",s);n.append("title");a(e)}o=false};i.onClick=function(e,n){var r=m(n).keyAccessor(e);t.events.trigger(function(){i.filter(r);i.redrawGroup()})};i._doRedraw=function(){for(var e=0;e<u.length;++e){a(e);if(o){i.svg().selectAll("g."+m(e).name+" path").attr("d",s)}}o=false};i.overlayGeoJson=function(e,t,n){for(var r=0;r<u.length;++r){if(u[r].name==t){u[r].data=e;u[r].keyAccessor=n;return i}}u.push({name:t,data:e,keyAccessor:n});return i};i.projection=function(e){s.projection(e);o=true;return i};i.geoJsons=function(){return u};i.removeGeoJson=function(e){var t=[];for(var n=0;n<u.length;++n){var r=u[n];if(r.name!=e){t.push(r)}}u=t;return i};return i.anchor(n,r)};t.bubbleOverlay=function(n,r){function l(){a=u.select("g."+i);if(a.empty())a=u.svg().append("g").attr("class",i);return a}function c(){var e=h();f.forEach(function(n){var r=p(n,e);var i=r.select("circle."+o);if(i.empty())i=r.append("circle").attr("class",o).attr("r",0).attr("fill",u.getColor).on("click",u.onClick);t.transition(i,u.transitionDuration()).attr("r",function(e){return u.bubbleR(e)});u._doRenderLabel(r);u._doRenderTitles(r)})}function h(){var e={};u.data().forEach(function(t){e[u.keyAccessor()(t)]=t});return e}function p(e,n){var r=s+" "+t.utils.nameToId(e.name);var i=a.select("g."+t.utils.nameToId(e.name));if(i.empty()){i=a.append("g").attr("class",r).attr("transform","translate("+e.x+","+e.y+")")}i.datum(n[e.name]);return i}function d(){var e=h();f.forEach(function(n){var r=p(n,e);var i=r.select("circle."+o);t.transition(i,u.transitionDuration()).attr("r",function(e){return u.bubbleR(e)}).attr("fill",u.getColor);u.doUpdateLabels(r);u.doUpdateTitles(r)})}var i="bubble-overlay";var s="node";var o="bubble";var u=t.bubbleMixin(t.baseMixin({}));var a;var f=[];u.transitionDuration(750);u.radiusValueAccessor(function(e){return e.value});u.point=function(e,t,n){f.push({name:e,x:t,y:n});return u};u._doRender=function(){a=l();u.r().range([u.MIN_RADIUS,u.width()*u.maxBubbleRelativeSize()]);c();u.fadeDeselectedArea();return u};u._doRedraw=function(){d();u.fadeDeselectedArea();return u};u.debug=function(n){if(n){var r=u.select("g."+t.constants.DEBUG_GROUP_CLASS);if(r.empty())r=u.svg().append("g").attr("class",t.constants.DEBUG_GROUP_CLASS);var i=r.append("text").attr("x",10).attr("y",20);r.append("rect").attr("width",u.width()).attr("height",u.height()).on("mousemove",function(){var t=e.mouse(r.node());var n=t[0]+", "+t[1];i.text(n)})}else{u.selectAll(".debug").remove()}return u};u.anchor(n,r);return u};t.rowChart=function(n,r){function y(){if(!d||v){var t=e.extent(g,p.cappedValueAccessor);if(t[0]>0)t[0]=0;d=e.scale.linear().domain(t).range([0,p.effectiveWidth()])}m.scale(d)}function b(){var e=i.select("g.axis");y();if(e.empty())e=i.append("g").attr("class","axis").attr("transform","translate(0, "+p.effectiveHeight()+")");t.transition(e,p.transitionDuration()).call(m)}function w(){i.selectAll("g.tick").select("line.grid-line").remove();i.selectAll("g.tick").append("line").attr("class","grid-line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",function(){return-p.effectiveHeight()})}function E(){g=p.data();b();w();var e=i.selectAll("g."+l).data(g);S(e);x(e);T(e)}function S(e){var t=e.enter().append("g").attr("class",function(e,t){return l+" _"+t});t.append("rect").attr("width",0);C(t);k(e)}function x(e){e.exit().remove()}function T(e){var n=g.length;var r;if(!f)r=(p.effectiveHeight()-(n+1)*a)/n;else r=f;var i=e.attr("transform",function(e,t){return"translate(0,"+((t+1)*a+t*r)+")"}).select("rect").attr("height",r).attr("fill",p.getColor).on("click",L).classed("deselected",function(e){return p.hasFilter()?!O(e):false}).classed("selected",function(e){return p.hasFilter()?O(e):false});t.transition(i,p.transitionDuration()).attr("width",function(e){var t=d(0)==-Infinity?d(1):d(0);return Math.abs(t-d(p.valueAccessor()(e)))}).attr("transform",A);N(e);k(e)}function N(e){if(p.renderTitle()){e.selectAll("title").remove();e.append("title").text(p.title())}}function C(e){if(p.renderLabel()){e.append("text").on("click",L)}if(p.renderTitleLabel()){e.append("text").attr("class",c).on("click",L)}}function k(e){if(p.renderLabel()){var n=e.select("text").attr("x",s).attr("y",o).on("click",L).attr("class",function(e,t){return l+" _"+t}).text(function(e){return p.label()(e)});t.transition(n,p.transitionDuration()).attr("transform",A)}if(p.renderTitleLabel()){var r=e.select("."+c).attr("x",p.effectiveWidth()-u).attr("y",o).attr("text-anchor","end").on("click",L).attr("class",function(e,t){return c+" _"+t}).text(function(e){return p.title()(e)});t.transition(r,p.transitionDuration()).attr("transform",A)}}function L(e){p.onClick(e)}function A(e){var t=d(p.cappedValueAccessor(e)),n=d(0),r=t>n?n:t;return"translate("+r+",0)"}function O(e){return p.hasFilter(p.cappedKeyAccessor(e))}var i;var s=10;var o=15;var u=2;var a=5;var f=false;var l="row";var c="titlerow";var h=false;var p=t.capMixin(t.marginMixin(t.colorMixin(t.baseMixin({}))));var d;var v;var m=e.svg.axis().orient("bottom");var g;p.rowsCap=p.cap;p._doRender=function(){p.resetSvg();i=p.svg().append("g").attr("transform","translate("+p.margins().left+","+p.margins().top+")");E();return p};p.title(function(e){return p.cappedKeyAccessor(e)+": "+p.cappedValueAccessor(e)});p.label(p.cappedKeyAccessor);p.x=function(e){if(!arguments.length)return d;d=e;return p};p.renderTitleLabel=function(e){if(!arguments.length)return h;h=e;return p};p._doRedraw=function(){E();return p};p.xAxis=function(){return m};p.fixedBarHeight=function(e){if(!arguments.length)return f;f=e;return p};p.gap=function(e){if(!arguments.length)return a;a=e;return p};p.elasticX=function(e){if(!arguments.length)return v;v=e;return p};p.labelOffsetX=function(e){if(!arguments.length)return s;s=e;return p};p.labelOffsetY=function(e){if(!arguments.length)return o;o=e;return p};p.titleLabelOffsetX=function(e){if(!arguments.length)return u;u=e;return p};return p.anchor(n,r)};t.legend=function(){function h(){return u+o}var e=2;var n={},r,i=0,s=0,o=12,u=5,a=false,f=560,l=70;var c;n.parent=function(e){if(!arguments.length)return r;r=e;return n};n.render=function(){r.svg().select("g.dc-legend").remove();c=r.svg().append("g").attr("class","dc-legend").attr("transform","translate("+i+","+s+")");var n=r.legendables();var u=c.selectAll("g.dc-legend-item").data(n).enter().append("g").attr("class","dc-legend-item").on("mouseover",function(e){r.legendHighlight(e)}).on("mouseout",function(e){r.legendReset(e)}).on("click",function(e){r.legendToggle(e)});c.selectAll("g.dc-legend-item").classed("fadeout",function(e){return e.chart.isLegendableHidden(e)});if(n.some(t.pluck("dashstyle"))){u.append("line").attr("x1",0).attr("y1",o/2).attr("x2",o).attr("y2",o/2).attr("stroke-width",2).attr("stroke-dasharray",t.pluck("dashstyle")).attr("stroke",t.pluck("color"))}else{u.append("rect").attr("width",o).attr("height",o).attr("fill",function(e){return e?e.color:"blue"})}u.append("text").text(t.pluck("name")).attr("x",o+e).attr("y",function(){return o/2+(this.clientHeight?this.clientHeight:13)/2-2});var p=0;var d=0;u.attr("transform",function(e,t){if(a){var n="translate("+p+","+d*h()+")";if(p+l>=f){++d;p=0}else{p+=l}return n}else{return"translate(0,"+t*h()+")"}})};n.x=function(e){if(!arguments.length)return i;i=e;return n};n.y=function(e){if(!arguments.length)return s;s=e;return n};n.gap=function(e){if(!arguments.length)return u;u=e;return n};n.itemHeight=function(e){if(!arguments.length)return o;o=e;return n};n.horizontal=function(e){if(!arguments.length)return a;a=e;return n};n.legendWidth=function(e){if(!arguments.length)return f;f=e;return n};n.itemWidth=function(e){if(!arguments.length)return l;l=e;return n};return n};t.scatterPlot=function(n,r){function c(n,r){var o=i.selectAll(".chart-body path.symbol").filter(function(t){return n(e.select(this))});var u=s.size();s.size(Math.pow(r,2));t.transition(o,i.transitionDuration()).attr("d",s);s.size(u)}function h(e){var n=i.selectAll(".chart-body path.symbol").each(function(t){this.filtered=e&&e.isFiltered(t.key)});t.transition(n,i.transitionDuration()).attr("d",s)}var i=t.coordinateGridMixin({});var s=e.svg.symbol();var o=i.keyAccessor();i.keyAccessor(function(e){return o(e)[0]});i.valueAccessor(function(e){return o(e)[1]});i.colorAccessor(function(e){return i._groupName});var u=function(e){return"translate("+i.x()(i.keyAccessor()(e))+","+i.y()(i.valueAccessor()(e))+")"};var a=3;var f=5;var l=0;s.size(function(e){if(e.value===0)return l;else if(this.filtered)return Math.pow(f,2);else return Math.pow(a,2)});t.override(i,"_filter",function(e){if(!arguments.length)return i.__filter();return i.__filter(t.filters.RangedTwoDimensionalFilter(e))});i.plotData=function(){var e=i.chartBodyG().selectAll("path.symbol").data(i.data());e.enter().append("path").attr("class","symbol").attr("opacity",0).attr("fill",i.getColor).attr("transform",u);t.transition(e,i.transitionDuration()).attr("opacity",function(e){return e.value?1:0}).attr("fill",i.getColor).attr("transform",u).attr("d",s);t.transition(e.exit(),i.transitionDuration()).attr("opacity",0).remove()};i.symbol=function(e){if(!arguments.length)return s.type();s.type(e);return i};i.symbolSize=function(e){if(!arguments.length)return a;a=e;return i};i.highlightedSize=function(e){if(!arguments.length)return f;f=e;return i};i.hiddenSize=function(e){if(!arguments.length)return l;l=e;return i};i.legendables=function(){return[{chart:i,name:i._groupName,color:i.getColor()}]};i.legendHighlight=function(t){c(function(e){return e.attr("fill")==t.color},f);i.selectAll(".chart-body path.symbol").filter(function(){return e.select(this).attr("fill")!=t.color}).classed("fadeout",true)};i.legendReset=function(t){c(function(e){return e.attr("fill")==t.color},a);i.selectAll(".chart-body path.symbol").filter(function(){return e.select(this).attr("fill")!=t.color}).classed("fadeout",false)};i.setHandlePaths=function(){};i.extendBrush=function(){var e=i.brush().extent();if(i.round()){e[0]=e[0].map(i.round());e[1]=e[1].map(i.round());i.g().select(".brush").call(i.brush().extent(e))}return e};i.brushIsEmpty=function(e){return i.brush().empty()||!e||e[0][0]>=e[1][0]||e[0][1]>=e[1][1]};i._brushing=function(){var e=i.extendBrush();i.redrawBrush(i.g());if(i.brushIsEmpty(e)){t.events.trigger(function(){i.filter(null);t.redrawAll(i.chartGroup())});h(false)}else{var n=t.filters.RangedTwoDimensionalFilter(e);t.events.trigger(function(){i.filter(null);i.filter(n);t.redrawAll(i.chartGroup())},t.constants.EVENT_DELAY);h(n)}};i.setBrushY=function(e){e.call(i.brush().y(i.y()))};return i.anchor(n,r)};t.numberDisplay=function(n,r){var i="number-display";var s=e.format(".2s");var o=t.baseMixin({});o._mandatoryAttributes(["group"]);o.value=function(){return o.data()};o.data(function(e){var t=e.value?e.value():e.top(1)[0];return o.valueAccessor()(t)});o.transitionDuration(250);o._doRender=function(){var t=o.value(),n=o.selectAll("."+i);if(n.empty())n=n.data([0]).enter().append("span").attr("class",i);n.transition().duration(o.transitionDuration()).ease("quad-out-in").tween("text",function(){var n=e.interpolateNumber(this.lastValue||0,t);this.lastValue=t;return function(e){this.textContent=o.formatNumber()(n(e))}})};o._doRedraw=function(){return o._doRender()};o.formatNumber=function(e){if(!arguments.length)return s;s=e;return o};return o.anchor(n,r)};t.heatMap=function(n,r){function d(e,n){var r=l.selectAll(".box-group").filter(function(t){return t.key[e]==n});var i=r.filter(function(e){return!l.hasFilter(e.key)});t.events.trigger(function(){if(i.empty()){r.each(function(e){l.filter(e.key)})}else{i.each(function(e){l.filter(e.key)})}l.redrawGroup()})}function v(e,t,n){return!t||n[t-1]!=e}var i=6.75;var s;var o;var u;var a=i;var f=i;var l=t.colorMixin(t.marginMixin(t.baseMixin({})));l._mandatoryAttributes(["group"]);l.title(l.colorAccessor());var c=function(e){d(0,e)};var h=function(e){d(1,e)};var p=function(e){var n=e.key;t.events.trigger(function(){l.filter(n);l.redrawGroup()})};t.override(l,"filter",function(e){if(!arguments.length)return l._filter();return l._filter(t.filters.TwoDimensionalFilter(e))});l.rows=function(t){if(arguments.length){u=t;return l}if(u)return u;var n=l.data().map(l.valueAccessor());n.sort(e.ascending);return e.scale.ordinal().domain(n.filter(v))};l.cols=function(t){if(arguments.length){o=t;return l}if(o)return o;var n=l.data().map(l.keyAccessor());n.sort(e.ascending);return e.scale.ordinal().domain(n.filter(v))};l._doRender=function(){l.resetSvg();s=l.svg().append("g").attr("class","heatmap").attr("transform","translate("+l.margins().left+","+l.margins().top+")");return l._doRedraw()};l._doRedraw=function(){var e=l.rows(),n=l.cols(),r=e.domain().length,i=n.domain().length,o=Math.floor(l.effectiveWidth()/i),u=Math.floor(l.effectiveHeight()/r);n.rangeRoundBands([0,l.effectiveWidth()]);e.rangeRoundBands([l.effectiveHeight(),0]);var c=s.selectAll("g.box-group").data(l.data(),function(e,t){return l.keyAccessor()(e,t)+"\0"+l.valueAccessor()(e,t)});var h=c.enter().append("g").attr("class","box-group");h.append("rect").attr("class","heat-box").attr("fill","white").on("click",l.boxOnClick());h.append("title").text(l.title());t.transition(c.selectAll("rect"),l.transitionDuration()).attr("x",function(e,t){return n(l.keyAccessor()(e,t))}).attr("y",function(t,n){return e(l.valueAccessor()(t,n))}).attr("rx",a).attr("ry",f).attr("fill",l.getColor).attr("width",o).attr("height",u);c.exit().remove();var p=s.selectAll("g.cols");if(p.empty())p=s.append("g").attr("class","cols axis");p.selectAll("text").data(n.domain()).enter().append("text").attr("x",function(e){return n(e)+o/2}).style("text-anchor","middle").attr("y",l.effectiveHeight()).attr("dy",12).on("click",l.xAxisOnClick()).text(function(e){return e});var d=s.selectAll("g.rows");if(d.empty())d=s.append("g").attr("class","rows axis");d.selectAll("text").data(e.domain()).enter().append("text").attr("dy",6).style("text-anchor","end").attr("x",0).attr("dx",-2).on("click",l.yAxisOnClick()).text(function(e){return e});t.transition(d.selectAll("text"),l.transitionDuration()).text(function(e){return e}).attr("y",function(t){return e(t)+u/2});if(l.hasFilter()){l.selectAll("g.box-group").each(function(e){if(l.isSelectedNode(e)){l.highlightSelected(this)}else{l.fadeDeselected(this)}})}else{l.selectAll("g.box-group").each(function(){l.resetHighlight(this)})}return l};l.boxOnClick=function(e){if(!arguments.length)return p;p=e;return l};l.xAxisOnClick=function(e){if(!arguments.length)return c;c=e;return l};l.yAxisOnClick=function(e){if(!arguments.length)return h;h=e;return l};l.xBorderRadius=function(e){if(arguments.length){a=e}return a};l.yBorderRadius=function(e){if(arguments.length){f=e}return f};l.isSelectedNode=function(e){return l.hasFilter(e.key)};return l.anchor(n,r)};(function(){function t(e){return[0,e.length-1]}function n(t){return[e.quantile(t,.25),e.quantile(t,.5),e.quantile(t,.75)]}e.box=function(){function c(t){t.each(function(t,n){t=t.map(u).sort(e.ascending);var c=e.select(this),h=t.length,p=t[0],d=t[h-1];var v=t.quartiles=f(t);var m=a&&a.call(this,t,n),g=m&&m.map(function(e){return t[e]});var y=m?e.range(0,m[0]).concat(e.range(m[1]+1,h)):e.range(h);var b=e.scale.linear().domain(o&&o.call(this,t,n)||[p,d]).range([i,0]);var w=this.__chart__||e.scale.linear().domain([0,Infinity]).range(b.range());this.__chart__=b;var E=c.selectAll("line.center").data(g?[g]:[]);E.enter().insert("line","rect").attr("class","center").attr("x1",r/2).attr("y1",function(e){return w(e[0])}).attr("x2",r/2).attr("y2",function(e){return w(e[1])}).style("opacity",1e-6).transition().duration(s).style("opacity",1).attr("y1",function(e){return b(e[0])}).attr("y2",function(e){return b(e[1])});E.transition().duration(s).style("opacity",1).attr("y1",function(e){return b(e[0])}).attr("y2",function(e){return b(e[1])});E.exit().transition().duration(s).style("opacity",1e-6).attr("y1",function(e){return b(e[0])}).attr("y2",function(e){return b(e[1])}).remove();var S=c.selectAll("rect.box").data([v]);S.enter().append("rect").attr("class","box").attr("x",0).attr("y",function(e){return w(e[2])}).attr("width",r).attr("height",function(e){return w(e[0])-w(e[2])}).transition().duration(s).attr("y",function(e){return b(e[2])}).attr("height",function(e){return b(e[0])-b(e[2])});S.transition().duration(s).attr("y",function(e){return b(e[2])}).attr("height",function(e){return b(e[0])-b(e[2])});var x=c.selectAll("line.median").data([v[1]]);x.enter().append("line").attr("class","median").attr("x1",0).attr("y1",w).attr("x2",r).attr("y2",w).transition().duration(s).attr("y1",b).attr("y2",b);x.transition().duration(s).attr("y1",b).attr("y2",b);var T=c.selectAll("line.whisker").data(g||[]);T.enter().insert("line","circle, text").attr("class","whisker").attr("x1",0).attr("y1",w).attr("x2",r).attr("y2",w).style("opacity",1e-6).transition().duration(s).attr("y1",b).attr("y2",b).style("opacity",1);T.transition().duration(s).attr("y1",b).attr("y2",b).style("opacity",1);T.exit().transition().duration(s).attr("y1",b).attr("y2",b).style("opacity",1e-6).remove();var N=c.selectAll("circle.outlier").data(y,Number);N.enter().insert("circle","text").attr("class","outlier").attr("r",5).attr("cx",r/2).attr("cy",function(e){return w(t[e])}).style("opacity",1e-6).transition().duration(s).attr("cy",function(e){return b(t[e])}).style("opacity",1);N.transition().duration(s).attr("cy",function(e){return b(t[e])}).style("opacity",1);N.exit().transition().duration(s).attr("cy",function(e){return b(t[e])}).style("opacity",1e-6).remove();var C=l||b.tickFormat(8);var k=c.selectAll("text.box").data(v);k.enter().append("text").attr("class","box").attr("dy",".3em").attr("dx",function(e,t){return t&1?6:-6}).attr("x",function(e,t){return t&1?r:0}).attr("y",w).attr("text-anchor",function(e,t){return t&1?"start":"end"}).text(C).transition().duration(s).attr("y",b);k.transition().duration(s).text(C).attr("y",b);var L=c.selectAll("text.whisker").data(g||[]);L.enter().append("text").attr("class","whisker").attr("dy",".3em").attr("dx",6).attr("x",r).attr("y",w).text(C).style("opacity",1e-6).transition().duration(s).attr("y",b).style("opacity",1);L.transition().duration(s).text(C).attr("y",b).style("opacity",1);L.exit().transition().duration(s).attr("y",b).style("opacity",1e-6).remove()});e.timer.flush()}var r=1,i=1,s=0,o=null,u=Number,a=t,f=n,l=null;c.width=function(e){if(!arguments.length)return r;r=e;return c};c.height=function(e){if(!arguments.length)return i;i=e;return c};c.tickFormat=function(e){if(!arguments.length)return l;l=e;return c};c.duration=function(e){if(!arguments.length)return s;s=e;return c};c.domain=function(t){if(!arguments.length)return o;o=t==null?t:e.functor(t);return c};c.value=function(e){if(!arguments.length)return u;u=e;return c};c.whiskers=function(e){if(!arguments.length)return a;a=e;return c};c.quartiles=function(e){if(!arguments.length)return f;f=e;return c};return c}})();t.boxPlot=function(n,r){function h(e){var t=e.enter().append("g");t.attr("class","box").attr("transform",c).call(a).on("click",function(e){i.filter(e.key);i.redrawGroup()})}function p(n){t.transition(n,i.transitionDuration()).attr("transform",c).call(a).each(function(){e.select(this).select("rect.box").attr("fill",i.getColor)})}function d(e){e.exit().remove().call(a)}function v(e){return function(t){var n=t.quartiles[0],r=t.quartiles[2],i=(r-n)*e,s=-1,o=t.length;while(t[++s]<n-i);while(t[--o]>r+i);return[s,o]}}var i=t.coordinateGridMixin({});var s=1.5;var o=v;var u=o(s);var a=e.box();var f=null;var l=function(e,t){if(i.isOrdinal())return i.x().rangeBand();else return e/(1+i.boxPadding())/t};i.yAxisPadding(12);i.x(e.scale.ordinal());i.xUnits(t.units.ordinal);i.data(function(e){return e.all().map(function(e){e.map=function(t){return t.call(e,e)};return e}).filter(function(e){var t=i.valueAccessor()(e);return t.length!==0})});i.boxPadding=i._rangeBandPadding;i.boxPadding(.8);i.outerPadding=i._outerRangeBandPadding;i.outerPadding(.5);i.boxWidth=function(t){if(!arguments.length)return l;l=e.functor(t);return i};var c=function(e,t){var n=i.x()(i.keyAccessor()(e,t));return"translate("+n+",0)"};i._preprocessData=function(){if(i.elasticX()){i.x().domain([])}};i.plotData=function(){var e=l(i.effectiveWidth(),i.xUnitCount());a.whiskers(u).width(e).height(i.effectiveHeight()).value(i.valueAccessor()).domain(i.y().domain()).duration(i.transitionDuration()).tickFormat(f);var t=i.chartBodyG().selectAll("g.box").data(i.data(),function(e){return e.key});h(t);p(t);d(t);i.fadeDeselectedArea()};i.fadeDeselectedArea=function(){if(i.hasFilter()){i.g().selectAll("g.box").each(function(e){if(i.isSelectedNode(e)){i.highlightSelected(this)}else{i.fadeDeselected(this)}})}else{i.g().selectAll("g.box").each(function(){i.resetHighlight(this)})}};i.isSelectedNode=function(e){return i.hasFilter(e.key)};i.yAxisMin=function(){var n=e.min(i.data(),function(t){return e.min(i.valueAccessor()(t))});return t.utils.subtract(n,i.yAxisPadding())};i.yAxisMax=function(){var n=e.max(i.data(),function(t){return e.max(i.valueAccessor()(t))});return t.utils.add(n,i.yAxisPadding())};i.tickFormat=function(e){if(!arguments.length)return f;f=e;return i};return i.anchor(n,r)};t.abstractBubbleChart=t.bubbleMixin;t.baseChart=t.baseMixin;t.capped=t.capMixin;t.colorChart=t.colorMixin;t.coordinateGridChart=t.coordinateGridMixin;t.marginable=t.marginMixin;t.stackableChart=t.stackMixin;return t}if(typeof define==="function"&&define.amd){define(["d3"],e)}else if(typeof module==="object"&&module.exports){module.exports=e(d3)}else{this.dc=e(d3)}})()