<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <title>Catalyst</title>
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" type="text/css" media="screen" href="css/bootstrap.css">
    <link rel="stylesheet" type="text/css" media="screen" href="css/catalyst.css">
    <link rel="stylesheet" type="text/css" media="screen" href="css/smartCustom.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="css/jqueryUI.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="js/jquery-filetree/jqueryFileTree.css" />
  </head>
  <body class="custom-theme">
    <!-- HEADER -->
    <!-- Header starts here -->
    <header>
      <nav class="navbar navbar-default">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          </button>
        </div>
        <div class="navbar-brand"><img src="img/logo.png" class="iconLogo" alt="logo"></div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <!--left side navbar-->
          <ul class="nav navbar-nav">
            <li class="left-projects-links hidden" data-target="#Workspace" navigation="Workspace,Workspace1">
              <a class="active navigationTab" id="workZoneNew" href="#" onclick="setleftnavigation(this,'org');">
              <i class="fa fa-credit-card txt-color-blue"></i>&nbsp;WORKZONE 
              </a>
            </li>
            <!--design starts here-->
            <li class="left-projects-links hidden" id="designStyle" data-target="#blueprints"  navigation="blueprints">
              <a href="#ajax/Aws-Production.html" id="designNew" onclick="setleftnavigation(this,'Design');" class="navigationTab">
              <i class="fa fa-puzzle-piece"></i>&nbsp;DESIGN
              </a>
            </li>
            <!--track-->
            <li class="left-projects-links hidden" id="trackStyle" data-target="#Track" navigation="Track">
              <a class="dropdown-toggle navigationTab" href="#ajax/trackSettings.html" id="trackNew"  onclick="setleftnavigation(this,'Track');"><i class="fa fa-anchor"></i>&nbsp;TRACK</a>
            </li>
            <!--track ends here-->
            <!--right side navbar-->
            <span class="navRight">
              <li class="left-projects-links active" id="liuserinfo"></li>
              <!--Settings tab-->
              <li class="left-projects-links hidden" data-target="#Settings"   navigation="Settings">
                <a class="dropdown-toggle navigationTab" href="#ajax/Settings/Dashboard.html" id="settingsNew"  onclick="setleftnavigation(this,'Settings');"><i class="fa fa-cog"></i>&nbsp;SETTINGS</a>
              </li>
              <!--help-->
              <li class="left-projects-links"><a href="https://catalyst.readthedocs.org" target="_blank" id="dokuNew"><i class="fa fa-question"></i>&nbsp;Help</a>
              </li>
              <!--logout-->
              <li id="logout" class="btn-header transparent pull-right logouttop">
                <!-- ../auth/signout -->
                <span><a href="#" logoutlink="/auth/signout" title="Sign Out">
                <i class="fa fa-sign-out"></i>
                </a></span>
              </li>
            </span>
          </ul>
        </div>
      </nav>
    </header>
    <!--HEADER ends here -->
    <!-- Left panel : Navigation area -->
    <aside id="left-panel">
      <div id="Workspace1">
        <div class="leftSpaceStyle">
          <div class="hiddencollapse treeStyle">WORKZONE</div>
        </div>
        <div id="tree" class="font-size-12"></div>
      </div>
      <!--for track-->
      <div id="trackShow" style="display:none;">
        <div class="leftSpaceStyle">
          <div class="hiddencollapse treeStyle">TRACK</div>
        </div>
        <div id="trackTree" class="font-size-12"></div>
      </div>
      <!--track ends here-->
      <div id="Settings_nav" style="display:none;">
        <div class="leftSpaceStyle">
          <div class="hiddencollapse treeStyle">SETTINGS</div>
        </div>
        <div id="setting_tree" class="font-size-12"></div>
      </div>
      <nav class="font-size-12">
        </ul>
        <ul class="menu-item-parentdemo" id="Workspace">
        </ul>
        <ul class="menu-item-parentdemo hidden" id="Track">
        </ul>
        <ul class="menu-item-parentdemo hidden" id="blueprints" providerselected="aws">
          <li class="active open">
            <a href="#" class="activeProviderOpen"><i class="fa fa-lg fa-fw fa-sitemap"></i><span class="menu-item-parent trackAlign"><strong>PROVIDERS</strong></span>
            </a>
            <ul class="visibleClass">
              <li>
                <a href="ajax/Aws-Production.html" onclick="$('#blueprints').attr('providerselected','aws');" class="devops_providers">
                  <div class="aws" title="AWS"><span class="menu-item-parent provider-images trackAlign">&nbsp;&nbsp;AWS</span></div>
                </a>
              </li>
              <li>
                <a href="ajax/DesignBlueprintAzure.html?provider=azure" onclick="$('#blueprints').attr('providerselected','azure');"  class="devops_providers">
                  <div class="azure" title="Azure"><span class="menu-item-parent provider-images trackAlign">&nbsp;&nbsp;AZURE</span></div>
                </a>
              </li>
              <li>
                <a href="ajax/DesignBlueprint.html?provider=os" onclick="$('#blueprints').attr('providerselected','openstack');"  class="devops_providers">
                  <div class="openstack" title="Open Stack"><span class="menu-item-parent provider-images trackAlign">&nbsp;OPENSTACK</span></div>
                </a>
              </li>
              <li>
                <a href="ajax/DesignBlueprintVmware.html?provider=vmware" onclick="$('#blueprints').attr('providerselected','vmware');" class="devops_providers">
                  <div class="vmware" title="Vmware"><span class="menu-item-parent provider-images trackAlign">&nbsp;VMWARE</span></div>
                </a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <span class="minifyme"> <i class="fa fa-arrow-circle-left hit"></i> </span>
    </aside>
    <!-- END NAVIGATION -->
    <!-- MAIN PANEL -->
    <div id="main" role="main">
      <!-- RIBBON -->
      <div id="ribbon">
        <div class="demo1">
          <div id="hide-menu" style="margin-top:-3px;">
            <span> <a href="javascript:void(0);" title="Collapse Menu">
            <i class="fa fa-sitemap txt-color-lightwhite"></i></a> </span>
          </div>
        </div>
        <!-- breadcrumb -->
        <ol class="breadcrumb">
          <!-- This is auto generated -->
        </ol>
      </div>
      <!-- MAIN CONTENT -->
      <div id="content">
      </div>
      <!--hiding the comment for no org available when the organization and environments are present-->
      <div id="noenvwarning" class="hidden alert alert-warning noEnvWarning">
        <img style="width:50px;height:40px" src="img/warning.png" alt="warning"/><span style="margin-left:20px;">Please Configure your Chef Server &amp; Environments. Check your</span>
        <ul style="list-style-type:none;text-align:center">
          <li class="left-projects-links hidden" data-target="#Settings" navigation="Settings">
            <a class="navigationTab" href="#ajax/Settings/Dashboard.html" id="settingsNewClick"  onclick="setleftnavigation(this,'Settings');">&nbsp;SETTINGS</a>
          </li>
        </ul>
      </div>
      <!--noEnv Error for consumer and designer-->
      <div id="noEnvError" class="hidden alert alert-warning noEnvWarningConsumerDesigner"><img style="width:50px;height:40px" src="img/warning.png" alt="warning"/><span style="margin-left:20px;">There are no Workzone items to display.</span>
      </div>
      <!--error ends-->
      <!-- END MAIN CONTENT -->
    </div>
    <!-- END MAIN PANEL -->
    <div id="shortcut" style="margin-left: 100px;margin-top: 90px;">
      <ul class="orgsList">
      </ul>
    </div>
    <!-- END SHORTCUT AREA -->
    <div id="main-collapse" style="margin-top: 50px;">
      <ul class="" style="width:100%">
        <li class="collapseActive">
          <a href="#ajax/Dev.html">WORKZONE</a>
        </li>
        <li>
          <a href="#ajax/Aws-Production.html">DESIGN</a>
        </li>
        <li>
          <a href="#ajax/Settings/OrgList.html"><span>SETTINGS</span></a>
        </li>
      </ul>
    </div>
    <!--modal for instance edit-->
    <div class="modal fade" id="modalforInstanceEdit" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
      <div class="modal-dialog">
        <div class="modal-content">
          <form role="form" class="cmxform" id="instanceEditNew">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
              <h4 class="modal-title">
                &nbsp;Edit Instance Name
              </h4>
            </div>
            <div class="modal-body">
              <fieldset>
                <div class="col-lg-6 col-md-6 col-sm-6">
                  <label for="instanceEditName">Name<span class="control-label redSpan">&nbsp;*</span></label>
                  <input type="text" name="instanceEditName" class="form-control" id="instanceEditName" autofocus/>
                </div>
                <input type="hidden" id="instanceIDHiddenInput">
              </fieldset>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
              <input type="submit" id="editSaveBTN" class="btn btn-primary" value="Save" />
            </div>
          </form>
        </div>
      </div>
    </div>
    <!--modal for instance edit ends-->
    <!--modal for blueprint read-->
    <div class="modal fade bs-example-modal-lg" id="modalForRead" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            <h4 class="modal-title" id="myModalLabel"></h4>
          </div>
          <div class="modal-body modalHeightHelp">
            <!--os and the 1st tier-->
            <table class="table table-bordered">
              <thead>
                <th class="paramStyle">Parameters</th>
                <th class="valueStyle">Values</th>
              </thead>
              <tbody>
                <tr>
                  <td class="tdStyleInfo">Blueprint Name:</td>
                  <td>
                    <input  id="blueprintNameInputNew" disabled="disabled" class="form-control">
                  </td>
                </tr>
                <tr>
                  <td class="tdStyleInfo">Template Type:</td>
                  <td>
                    <input id="blueprintTemplateType" disabled="disabled" class="form-control">
                  </td>
                </tr>
                <tr>
                  <td class="tdStyleInfo">Organisation Name:</td>
                  <td>
                    <input id="blueprintORG" disabled="disabled" class="form-control">
                  </td>
                </tr>
                <tr>
                  <td class="tdStyleInfo">Business Group:</td>
                  <td>
                    <input id="blueprintBU" disabled="disabled" class="form-control">
                  </td>
                </tr>
                <tr>
                  <td class="tdStyleInfo">Project Name:</td>
                  <td>
                    <input id="blueprintProject" disabled="disabled" class="form-control">
                  </td>
                </tr>
                <tr>
                  <td class="tdStyleInfo">Operating System:</td>
                  <td>
                    <input id="instanceOSNew" class="form-control" disabled="disabled">                                                      
                  </td>
                </tr>
                <tr>
                  <td class="tdStyleInfo">Instance Type:</td>
                  <td>
                    <input id="instancesizeNew" disabled="disabled" class="form-control">
                  </td>
                </tr>
                <tr>
                  <td class="tdStyleInfo">Provider Type:</td>
                  <td>
                    <input id="instanceProviderType" disabled="disabled" class="form-control">
                  </td>
                </tr>
                <tr>
                  <td class="tdStyleInfo">Provider Name:</td>
                  <td>
                    <input id="instanceProviderName" disabled="disabled" class="form-control">
                  </td>
                </tr>
                <tr>
                  <td class="tdStyleInfo">Region:</td>
                  <td>
                    <input id="instanceRegion" disabled="disabled" class="form-control">
                  </td>
                </tr>
                <tr>
                  <td class="tdStyleInfo">Image:</td>
                  <td>
                    <input id="instanceImage" disabled="disabled" class="form-control">
                  </td>
                </tr>
                <tr>
                  <td class="tdStyleInfo">Keypair:</td>
                  <td> 
                    <input id="instancekeyPair" disabled="disabled" class="form-control">
                  </td>
                </tr>
                <tr>
                  <td class="tdStyleInfo">VPC ID:</td>
                  <td>
                    <input id="instanceVPC" class="form-control" disabled="disabled">                                               
                  </td>
                </tr>
                <tr>
                  <td class="tdStyleInfo">Subnet:</td>
                  <td>
                    <input id="instanceSubnetId" class="form-control" disabled="disabled">                                          
                  </td>
                </tr>
                <tr>
                  <td class="tdStyleInfo">Security Group:</td>
                  <td>
                    <input id="instanceSecurityGroupId" class="form-control" disabled="disabled">
                  </td>
                </tr>
                <tr>
                  <td class="tdStyleInfo">Version:</td>
                  <td>
                    <input id="instanceVersion" class="form-control" disabled="disabled">                                    
                  </td>
                </tr>
                <tr>
                  <td class="tdStyleInfo">Runlist:</td>
                  <td>
                    <input id="instanceRunlist" class="form-control" disabled="disabled">                                           
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default btn-primary" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
    <!--modal for blueprint edit read-->
    <!--modal for blueprint read-->
    <div class="modal fade bs-example-modal-lg" id="modalForReadCFT" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            <h4 class="modal-title" class="titleCFTDocker" id="myModalLabel"></h4>
          </div>
          <div class="modal-body">
            <fieldset>
              <!--os and the 1st tier-->
              <table class="table table-bordered">
                <thead>
                  <th class="paramStyle">Parameters</th>
                  <th class="valueStyle">Values</th>
                </thead>
                <tbody>
                  <tr>
                    <td class="tdStyleInfo">Blueprint Name:</td>
                    <td>
                      <input  id="blueprintNameCFT" disabled="disabled" class="form-control">
                    </td>
                  </tr>
                  <tr>
                    <td class="tdStyleInfo">Template Type:</td>
                    <td>
                      <input id="blueprintTemplateTypeCFT" disabled="disabled" class="form-control">
                    </td>
                  </tr>
                  <tr>
                    <td class="tdStyleInfo">Organisation Name:</td>
                    <td>
                      <input id="blueprintORGCFT" disabled="disabled" class="form-control">
                    </td>
                  </tr>
                  <tr>
                    <td class="tdStyleInfo">Business Group:</td>
                    <td>
                      <input id="blueprintBUCFT" disabled="disabled" class="form-control">
                    </td>
                  </tr>
                  <tr>
                    <td class="tdStyleInfo">Project Name:</td>
                    <td>
                      <input id="blueprintProjectCFT" disabled="disabled" class="form-control">
                    </td>
                  </tr>
                  <tr>
                  <td class="tdStyleInfo">Version:</td>
                  <td>
                    <input id="instanceVersion" class="form-control" disabled="disabled">                                    
                  </td>
                </tr>
                </tbody>
              </table>
            </fieldset>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default btn-primary" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

    <!--modal for blueprint launch parameters -->
    <div class="modal fade bs-example-modal-lg" id="modalSelectEnvironment" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            <h4 class="modal-title" id="myModalLabel"><i class="fa fa-list-ol txt-color-blue"></i>&nbsp;Select Blueprint Launch Parameters</h4>
          </div>
          <div class="modal-body">
          <fieldset>
            <div class="col-lg-6 col-md-6">
                <label for="">Organization</label>
                <input id="blueprintOrgEnv" disabled="disabled" class="form-control">
            </div>


            <div class="col-lg-6 col-md-6">
                <label for="" class="">Business Group</label>
                <input id="blueprintBuEnv" disabled="disabled" class="form-control">
            </div>

            <div class="col-lg-6 col-md-6 projectRepo">
                <label for="" class="">Project Name
                </label>
                <input id="blueprintProEnv" disabled="disabled" class="form-control">
            </div>

            <div class="col-lg-6 col-md-6 projectRepo">
                <label for=""  class="">Choose Environment:</label>
                <select id="envSelect" class="width-100 form-control">
                </select>
            </div>
            <input type="hidden" id="selectedVersion"/>
          </fieldset>         
            </div>
            <div class="modal-footer">
                <a type="button" class="btn btn-default btn-default" data-dismiss="modal">Close</a>
                <button type="button" class="btn btn-default btn-primary launchBlueprintBtn" data-dismiss="modal">Launch</button>
             </div>
        </div>
      </div>
    </div>
    <!--modal ends here-->

    <!--modal for CFT launch-->
    <div class="modal fade" id="cftContainer" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">
       <div class="modal-dialog">
          <div class="modal-content">
             <form role="form" class="cmxform" id="cftForm">
                <div class="modal-header">
                   <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                   <h4 class="modal-title" id="myModalLabel">Enter a Unique Stack Name?</h4>
                </div>
                <div class="modal-body">
                   <i>(Only numbers,letters allowed. No spaces and underscores)</i>
                   <input type="text" uniqueconditionedby="cftInput" class="form-control" autofocus name="cftInput" id="cftInput"/>
                </div>
                <div class="modal-footer">
                   <a type="button" class="btn btn-default" data-dismiss="modal">Close</a>
                   <input type="submit" class="btn btn-default btn-primary" value="Submit">
                </div>
             </form>
          </div>
       </div>
    </div>

    <!--modal for launching the blueprint-->
    <div class="modal fade" id="launchResultContainer" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">
       <div class="modal-dialog">
          <div class="modal-content">
             <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="myModalLabel">Launching Blueprint</h4>
             </div>
             <div class="modal-body">
                ...
             </div>
             <div class="modal-footer">
                <button type="button" class="btn btn-default btn-primary" data-dismiss="modal">Close</button>
             </div>
          </div>
       </div>
    </div>
    <!--modal for launch ends here-->

         <!-- docker end -->

    <!--launching docker parameters-->
    <div class="modal fade bs-example-modal-lg" id="launchDockerInstanceSelector" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                    <h4 class="modal-title" id="DockerLaunch">Launch Docker Blueprint</h4>
                </div>
                <div class="modal-body">
                    <section id="wizard">
                        <form id="commentForm" action="">
                            <div id="rootwizard">
                                <ul style="display:none">
                                    <li><a href="#dockerTab1" data-toggle="tab">First</a></li>
                                    <li><a href="#dockerTab2" data-toggle="tab">Second</a></li>
                                </ul>
                                <div class="tab-content">
                                    <div class="tab-pane" id="dockerTab1">
                                        <div style="margin:0px;">
                                            <div class="col-lg-12 col-md-12 fordocker" style="margin-top:5px;">
                                                <label for="category">Docker Images:
                                                </label>
                                                <a class="btn btn-primary adddockertemplate pull-right hidden" onclick="showdockertemplateadder();">Add</a>
                                                <table class="table table-striped table-bordered table-hover dataTable no-footer" id="compositeDockerImagesTable" cellpadding="5px" width="100%">
                                                    <tr>
                                                        <th>Order</th>
                                                        <th>Name</th>
                                                        <th>Image Path</th>
                                                        <th>Tag</th>
                                                        <th>Launch Params</th>
                                                        <th>Action</th>
                                                    </tr>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="tab-pane" id="dockerTab2">
                                        <div id="dockerinstancesselctorview" style="margin-top: 26px;">
                                           <table class="table table-striped table-bordered table-hover dataTable no-footer" id="dockerinstancesTable" cellpadding="5px" width="100%">
                                              <thead>
                                                 <tr>
                                                     <th class="text-center">Select Instance</th>
                                                     <th class="text-center">Instance Name</th>
                                                     <th class="text-center">IP Address</th>
                                                     <th class="text-center">Log</th>
                                                 </tr>
                                              </thead>
                                              <tbody></tbody>
                                          </table>
                                        </div>
                                        <div class="btn-group">
                                            <a type="button" class="btn btn-default btn-primary hidden" data-dismiss="modal">Close</a>
                                        </div>
                                    </div>
                                    <ul class="pager wizard">
                                        <li class="previous disabled"><a href="javascript:void(0);" class="btn btn-primary dockerModal previousModal" style="border-radius:0px">Previous</a></li>
                                        <li class="next"><a href="javascript:void(0);" class="btn btn-primary dockerModal nextModal" style="border-radius:0px;margin-left:5px;">Next</a></li>
                                        <button type="button" class="btn btn-primary nav nav-pills dockerinstancestart hidden dockerModal startModal"><span class="startBTN">Start</span></button>
                                    </ul>
                                </div>
                            </div>
                        </form>
                    </section>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade bs-example-modal-lg" id="myModalLabelDockerContainer" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="DockerLaunch">Launch Parameters-Docker Blueprints</h4>
      </div>
      <div class="modal-body dockerModalHeight">
        <section>
          <form id="dockerparamsform" action="">
            <div style="margin:0px;">
              <div class="col-lg-6 col-md-6">
                <label for="category">Container Name<span style="color:red">*</span><span class="dockerparamrequired hidden" style="color:red">&nbsp;Required</span>
                </label>
                <input type="text" id="Containernamefield" name="namefield" class="required form-control" placeholder="" dockerparamkey="--name" onclick="$('.dockerparamrequired').addClass('hidden')">
              </div>
              <div class="col-lg-6 col-md-6">
                <label for="category">Port Mappings
                </label>
                <input type="text" id="Portmappingfield" name="Portmappingfield" class=" form-control" placeholder="Map host ports to container ports" dockerparamkey="-p">
              </div>
              <div class="col-lg-6 col-md-6 dockerModal">
                <label for="category">Volumes
                </label>
                <input type="text" id="Volumesfield" name="Volumesfield" class=" form-control" placeholder="Map host folders to container folders" dockerparamkey="-v">
              </div>
              <div class="col-lg-6 col-md-6 dockerModal">
                <label for="category">Volumes-from
                </label>
                <input type="text" id="Volumes-fromfield" name="Volumes-fromfield" class=" form-control" placeholder="Comma separated container names" dockerparamkey="--volumes-from">
              </div>
              <div class="col-lg-6 col-md-6 dockerModal">
                <label for="category">Linked Container
                </label>
                <input type="text" id="Linkedcontainerfield" name="Linkedcontainerfield" class=" form-control" placeholder="The name of a container this one links to" dockerparamkey="--link">
              </div>
              <div class="col-lg-6 col-md-6 dockerModal">
                <label for="category">Environment Variables
                </label>
                <input type="text" id="Environmentvariablesfield" name="Environmentvariablesfield" class=" form-control" placeholder="" dockerparamkey="-e">
              </div>
              <div class="col-lg-6 col-md-6 dockerModal">
                <label for="category">Startup Command
                </label>
                <input type="text" id="Startupcommandfield" name="Startupcommandfield" class=" form-control" placeholder="Optional startup command for the container" dockerparamkey="-c">
              </div>
              <div class="col-lg-6 col-md-6 dockerModal">
                <label for="category">Additional Startup
                </label>
                <input type="text" id="additionalStartupcommandfield" name="additionalStartupcommandfield" class=" form-control" placeholder="Additional startup command for the container" dockerparamkey="-exec">
              </div>
              <div class="col-lg-6 hidden">
                <label for="category">Removed Linked Containers on Exit
                </label>
                <select class="chooseSelect width-100 form-control" id="Removelinkedcontainersonexitfield" placeholder="Should this & linked containers be removed on exit">
                  <option>False</option>
                  <option>True</option>
                </select>
              </div>
              <div class="col-lg-6 dockerModal hidden">
                <label for="category">Remove on Exit
                </label>
                <select class="chooseSelectExit width-100 form-control" id="Removeonexitfield" placeholder="Should this container be removed when it exits">
                  <option>False</option>
                  <option>True</option>
                </select>
              </div>
              <div class="col-lg-6 hidden">
                <label for="">Startup Script</label>
                <label class="input input-file" for="file">
                  <div class="button">
                    <input type="file" id="Startupscriptfield" name="Startupscriptfield">Browse
                  </div>
                  <input type="text" readonly="">
                </label>
              </div>
            </div>
          </form>
        </section>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default btn-primary" onclick="if(generateDockerLaunchParams()!=''){$('#myModalLabelDockerContainer').modal('hide');}else{return(false);}">
        <i class="fa fa-save fa-1x"></i>&nbsp;Add</button>
        <button type="button" class="btn btn-default btn-primary" data-dismiss="modal">
        <i class="fa fa-undo fa-1x"></i>&nbsp;Cancel</button>
      </div>
    </div>
  </div>
</div>


<!--instance launching pad-->
<div class="modal fade" id="instanceLogModalContainer" tabindex="-1" style='z-index:1800' role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">
   <div class="modal-dialog">
      <div class="modal-content">
         <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            <h4 class="modal-title" id="myModalLabel">
               <i class="fa fa-bar-chart-o txt-color-blue"></i>&nbsp;&nbsp;Instance Logs
            </h4>
         </div>
         <div class="modal-body">
            <div class="logsArea font-size-12"></div>
         </div>
         <div class="modal-footer">
            <button type="button" class="btn btn-default btn-primary" data-dismiss="modal">Close</button>
         </div>
      </div>
   </div>
</div>




    
<script src="js/libs/jquery-2.0.2.min.js"></script>
<script src="js/libs/jquery-ui-1.10.3.min.js"></script>
<script src="js/libs/modernizr-2.5.3.min.js"></script>
<script src="js/select2.min.js"></script>
<script src="js/bootstrap-treeview.js"></script>

<script src="js/bootstrap/bootstrap.min.js"></script>
<!-- CUSTOM NOTIFICATION -->
<script src="js/notification/SmartNotification.min.js"></script>
<!-- JARVIS WIDGETS -->
<script src="js/smartwidgets/jarvis.widget.min.js"></script>
<script src="js/plugin/bootstrap-wizard/jquery.bootstrap.wizard.js"></script>
<script src="js/plugin/bootbox/bootbox.min.js"></script>

<script src="/private/js/jquery.dataTables.min.js"></script>
<script src="js/jquery.tablesorter.min.js"></script>
<script src="js/jquery.validate.min.js"></script>
<script src="js/additional-methods.min.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script src="js/app.js"></script>

<script src="js/dev/dev.js"></script>
    
<!-- MAIN APP JS FILE -->
<script type="text/javascript">
var a, b, x;
String.prototype.capitalizeFirstLetter = function() {
    return this.charAt(0).toUpperCase() + this.slice(1);
}


$(document).ready(function() {
    var hasSettingsPermission = false;
    if (haspermission("settings", "read")) {
        hasSettingsPermission = true;
    }
    if (!hasSettingsPermission) {
        $('#settingsNew').addClass('hidden');
        $('#noenvwarning').addClass('hidden');
        $('#noEnvError').removeClass('hidden');
    }

    var hasDesignPermission = false;
    if (haspermission("design", "read")) {
        hasDesignPermission = true;
    }

    if (!hasDesignPermission) {
        $('#designNew').addClass('hidden');
        $('#noenvwarning').addClass('hidden');
        $('#noEnvError').removeClass('hidden');
    }
});

//to get the org,BU and Proj and environment details, to be used in design
function getOrgProjBUComparison(data,id){
    data = JSON.parse(JSON.stringify(data));
    //clearing the select box.
    $('#envSelect').empty();
    $.get("/d4dMasters/readmasterjsonnew/4", function(tdata) {
        var $blueprintReadContainer = $(id);
        var $blueprintLaunch = $(id);
        var $blueprintReadContainerCFT = $(id);
        for (var i = 0; i < tdata.length; i += 1) {
            if (data.orgId == tdata[i].orgname_rowid) {
                $blueprintReadContainer.find('.modal-body #blueprintORG').val(tdata[i].orgname[0]);
                $blueprintLaunch.find('.modal-body #blueprintOrgEnv').val(tdata[i].orgname[0]);
                $blueprintReadContainerCFT.find('.modal-body #blueprintORGCFT').val(tdata[i].orgname[0]);
            }
            if (data.bgId == tdata[i].productgroupname_rowid) {
                $blueprintReadContainer.find('.modal-body #blueprintBU').val(tdata[i].productgroupname);
                $blueprintLaunch.find('.modal-body #blueprintBuEnv').val(tdata[i].productgroupname);
                $blueprintReadContainerCFT.find('.modal-body #blueprintBUCFT').val(tdata[i].orgname[0]);
            }
            if (data.projectId == tdata[i].rowid) {
                $blueprintReadContainer.find('.modal-body #blueprintProject').val(tdata[i].projectname);
                $blueprintLaunch.find('.modal-body #blueprintProEnv').val(tdata[i].projectname);
                $blueprintReadContainerCFT.find('.modal-body #blueprintProjectCFT').val(tdata[i].orgname[0]);
            }
            var envNames = tdata[i].environmentname.split(',');
            var envIds = tdata[i].environmentname_rowid.split(',');

            if(envNames.length === envIds.length){
                for(var j=0;j<envNames.length;j++){                                                                                                       
                    if (data.bgId == tdata[i].productgroupname_rowid){
                        if (data.projectId == tdata[i].rowid){
                            var $option = $('<option></option>').val(envIds[j]).html(envNames[j]);                                                                
                            $blueprintLaunch.find('.modal-body #envSelect').append($option);
                        }
                    }
                }
            }
        }
    });
}
var eventAdded = false;
//method for blueprint launch except docker.
function blueprintLaunchDesign(data) {
    console.log(data);
    bootbox.confirm({
        message: "Are you sure you want to launch the Blueprint? Press Ok To continue",
        title: "Confirmation",
        callback: function(result) {
            if (!result) {
                return;
            } else {
                $('#cftForm').trigger('reset');
                var blueprintType = data.templateType;
                //setting the envId as it is needed for bpLaunch.
                var envId = $('#envSelect').val();
                //setting the blueprint version.(different versions)
                var blueprintId = $('#modalSelectEnvironment').find('#selectedVersion').val();

                if (blueprintType === 'chef' || blueprintType === 'ami') {
                    var version = data.blueprintConfig.infraManagerData.latestVersion;
                }

                function launchBP(blueprintId, stackName) {
                    var $launchResultContainer = $('#launchResultContainer');
                    $launchResultContainer.find('.modal-body').empty().append('<img class="center-block" style="height:50px;width:50px;margin-top: 10%;margin-bottom: 10%;" src="img/loading.gif" />');
                    $launchResultContainer.find('.modal-title').html('Launching Blueprint');
                    $launchResultContainer.modal('show');
                    $.get('/blueprints/' + blueprintId + '/launch?version=' + version + '&envId=' + envId + '&stackName=' + stackName, function(data) {

                        var msgStr = 'Instance Id : ';
                        if (blueprintType === 'cft') {
                            msgStr = 'Stack Id : ' + data.stackId + '. You can view your stack in cloudformation tab(workzone)';
                        } else {
                            msgStr = 'Instance Id : ';
                            msgStr += data.id.join(',');

                            msgStr += '<br/>You can monitor logs from the Launched Instances.';
                        }

                        var $msg = $('<div></div>').append('<h3 style="font-size:16px;" class=\"alert alert-success\">Your Created Blueprint is being Launched, kindly check Workzone to view your instance.</h3>').append(msgStr);

                        $launchResultContainer.find('.modal-body').empty();
                        $launchResultContainer.find('.modal-body').append($msg);
                        if (blueprintType === 'cft') {
                            return;
                        }
                        var instanceId = data.id;
                        var timeout;

                        $launchResultContainer.on('hidden.bs.modal', function(e) {
                            $launchResultContainer.off('hidden.bs.modal');
                            if (timeout) {
                                clearTimeout(timeout);
                            }
                        });
                        $divBootstrapLogArea = $('<div></div>').addClass('logsAreaBootstrap');

                        $launchResultContainer.find('.modal-body').append($divBootstrapLogArea);

                        var lastTimestamp;

                        function pollLogs(timestamp, delay, clearData) {
                            var url = '../instances/' + instanceId + '/logs';
                            if (timestamp) {
                                url = url + '?timestamp=' + timestamp;
                            }

                            timeout = setTimeout(function() {
                                $.get(url, function(data) {
                                    var $modalBody = $divBootstrapLogArea;
                                    if (clearData) {
                                        $modalBody.empty();
                                    }
                                    var $table = $('<div></div>');

                                    for (var i = 0; i < data.length; i++) {
                                        var $rowDiv = $('<div class="row"></div>');
                                        var timeString = new Date().setTime(data[i].timestamp);
                                        var date = new Date(timeString).toLocaleString(); //converts to human readable strings
                                        if (data[i].err) {
                                            $rowDiv.append($('<div class="col-lg-12 col-sm-12" style="color:red;"></div>').append('<span>' + data[i].log + '</span>'));
                                        } else {
                                            $rowDiv.append($('<div class="col-lg-12 col-sm-12 " style="color:white;"></div>').append('<span>' + data[i].log + '</span>'));
                                        }

                                        $table.append($rowDiv);
                                    }
                                    if (data.length) {
                                        lastTimestamp = data[data.length - 1].timestamp;
                                        $modalBody.append($table);
                                        $modalBody.scrollTop($modalBody[0].scrollHeight + 100);
                                    }


                                    console.log('polling again');
                                    if ($launchResultContainer.data()['bs.modal'].isShown) {
                                        pollLogs(lastTimestamp, 1000, false);
                                    } else {
                                        console.log('not polling again');
                                    }
                                });
                            }, delay);
                        }
                        if (data.id.length <= 1) {
                            instanceId = data.id[0];
                            //to be called only when there is one instance.
                            pollLogs(lastTimestamp, 0, true);
                        } else {
                            for (var j = 0; j < data.id.length; j++) {
                                if (j >= data.id.length - 1) {
                                    $('.logsAreaBootstrap').hide();
                                }
                            }
                        }
                    }).error(function(jxhr) {
                        var message = "Server Behaved Unexpectedly";
                        if (jxhr.responseJSON && jxhr.responseJSON.message) {
                            message = jxhr.responseJSON.message;
                        }
                        $launchResultContainer.find('.modal-body').empty().append('<span>' + message + '</span>');
                    });

                }

                if (blueprintType === 'cft') {
                    jQuery.validator.addMethod("noSpace", function(value, element) {
                        return value.indexOf(" ") < 0 && value != "";
                    }, "No space allowed and the user can't leave it empty");
                    $('#cftContainer').modal('show');
                    var validator = $("#cftForm").validate({
                        rules: {
                            cftInput: {
                                noSpace: true,
                                alphanumeric: true
                            }
                        }
                    });
                    $('a.launchBtn[type="reset"]').on('click', function() {
                        validator.resetForm();
                    });

                    if (!eventAdded) {
                        $("#cftForm").submit(function(e) {
                            var stackName = $('#cftInput').val();
                            var isValid = $('#cftForm').valid();
                            if (!isValid) {
                                e.preventDefault();
                                return false;
                            } else {
                                var blueprintId = data._id;
                                if (!blueprintId) {
                                    blueprintId = $($selectedItems.get(0)).attr('data-blueprintId');
                                }
                                launchBP(blueprintId, stackName);
                                $('#cftContainer').modal('hide');
                                e.preventDefault();

                                return false;
                            }
                        });
                        eventAdded = true;
                    }
                } else {
                    launchBP(blueprintId);
                }
            }
        }
    });
}
//method for docker blueprint launch.
function dockerBlueprintLaunch(data){
  bootbox.confirm({
    message: "Are you sure you want to launch the Blueprint? Press Ok To continue",
    title: "Confirmation",
    callback: function(result) {
        if (!result) {
            return;
        } else {
            $('#commentForm')[0].reset();
            $('#Removeonexitfield').change();
            //clearing and redrawing the datatable.
            $dockerinstancesDatatable.clear().draw(false);

            var blueprintType = data.templateType;
            var projectId = data.projectId;
            var envId = $('#envSelect').val();
            var blueprintId = data._id;
            $.get('/instances', function(instanceData) {
                for (var i = 0; i < instanceData.length; i++) {
                    (function(i) {
                        var blueprintId = data._id;
                        $('.oldlaunchparams').empty(); //clearing the old div for composite blue print.
                        $('.dockerinstancestart').first().addClass('hidden');
                        var dockercompose = data.blueprintConfig.dockerCompose;
                        $('#compositeDockerImagesTable tr.dockerImagesRowDesign').detach(); //clearing previously loaded table.
                        dockercompose.forEach(function(k, v) {
                            addDockerImagesToTable(dockercompose[v]["dockercontainerpathstitle"], dockercompose[v]["dockercontainerpaths"], dockercompose[v]["dockerrepotags"], dockercompose[v]["dockerreponame"], dockercompose[v]["dockerlaunchparameters"]);
                        });

                        $('.dockerimageselectordown').click(function() {
                            movetablerow('dockerimageselectordown', $(this).attr('uniqueid'));
                        });

                        $('.dockerimageselectorup').click(function() {
                            movetablerow('dockerimageselectorup', $(this).attr('uniqueid'));
                        });

                        $('.btnaddDockerLaunchParams').click(function() {
                            var lp = generateDockerLaunchParams();
                            console.log(lp);
                            if (lp != '') {
                                var dockerParamsList = lp[0];

                                if ((lp[1] !== undefined) && (lp[1] != ''))
                                    dockerParamsList += ' -c ' + lp[1];

                                if ((lp[2] !== undefined) && (lp[2] != ''))
                                    dockerParamsList += ' -exec ' + lp[2];

                                $('#' + $('#myModalLabelDockerContainer').attr('saveto')).val(dockerParamsList);
                                $('#myModalLabelDockerContainer').removeAttr('saveto').modal('hide');
                            }
                        });

                        var $launchDockerInstanceSelector = $('#launchDockerInstanceSelector');
                        var blueprintId = data._id;
                        var dockerreponame = data.blueprintConfig.dockerRepoName;
                        $launchDockerInstanceSelector.data('blueprintId', blueprintId);
                        loadInstancesContainerList();

                        function loadInstancesContainerList() {
                            $launchDockerInstanceSelector.modal('show');
                            $('#rootwizard').find("a[href*='dockerTab1']").trigger('click'); //showing first tab.

                            var imagePath;
                            if (data.iconPath == undefined) {
                                imagePath = data.iconPath = 'img/imgo.jpg';
                            } else {
                                imagePath = data.iconPath;
                            }
                            if (envId === instanceData[i].envId) {
                                if (instanceData[i].instanceState == 'running') {
                                    var $tdcheckbox = '<div class="text-center"><input type="checkbox" class="instanceselectedfordocker"><img src="' + imagePath + '" style="width:40px;height:30px;" /></div>';
                                    var $tdname = '<div class="dockerinstanceClass text-center" data-instanceId="' + instanceData[i]._id + '" data-blueprintname="' + instanceData[i].blueprintData.blueprintName + '">' + instanceData[i].name + '</div>';
                                    var $tdinstanceip = '<div class="text-center">' + instanceData[i].instanceIP + '</div>';
                                    var $moreinfo = '<a data-original-title="MoreInfo" data-placement="top" rel="tooltip" href="javascript:void(0)" data-instanceId="' + instanceData[i]._id + '" class="tableMoreInfo moreInfo dockerintsancesmoreInfo"></a>';

                                    var $dockerinstancesDatatable = $('#dockerinstancesTable');
                                    $dockerinstancesDatatable.dataTable().fnAddData([
                                        $tdcheckbox,
                                        $tdname,
                                        $tdinstanceip,
                                        $moreinfo
                                    ]);
                                    $('.dockerinstancestart').unbind().click(function(e) {
                                        generateCompositeJsonfromtable();
                                        compositeDockerLaunch(data);
                                    });
                                    $dockerinstancesDatatable.on('click', '.dockerintsancesmoreInfo', instanceLogsHandler);
                                }
                            }
                        }
                        return;
                    })(i);
                }

            });
        }
    }
  });
}

var instanceLogsHandler = function(e) {
    var instanceId = $(this).attr('data-instanceId');
    var timeout;
    var $instanceLogModalContainer = $('#instanceLogModalContainer');
    $instanceLogModalContainer.on('hidden.bs.modal', function(e) {
        $instanceLogModalContainer.off('hidden.bs.modal');
        if (timeout) {
            clearTimeout(timeout);
        }
    });
    $instanceLogModalContainer.find('.logsArea').empty().append('<img class="center-block" style="height:50px;width:50px;margin-top: 10%;margin-bottom: 10%;" src="img/loading.gif" />');
    $instanceLogModalContainer.modal('show');
    var lastTimestamp;

    //Showing the log for Instances
    function pollLogs(timestamp, delay, clearData) {
        var url = '../instances/' + instanceId + '/logs';
        if (timestamp) {
            url = url + '?timestamp=' + timestamp;
        }

        timeout = setTimeout(function() {
            $.get(url, function(data) {
                var $modalBody = $instanceLogModalContainer.find('.logsArea')
                if (clearData) {
                    $modalBody.empty();
                }
                var $table = $('<table></table>');

                for (var i = 0; i < data.length; i++) {
                    var $rowDiv = $('<tr class="row rowSpacing"></tr>');
                    var timeString = new Date().setTime(data[i].timestamp);
                    var date = new Date(timeString).toLocaleString(); //converts to human readable strings
                    if (data[i].err) {
                        $rowDiv.append($('<td class="col-lg-12 col-sm-12" style="color:red;"></td>').append('<span class="textLogs">' + date + '</span>' + '&nbsp;&nbsp;&nbsp;' + '<span>' + data[i].log + '</span>'));
                    } else {
                        $rowDiv.append($('<td class="col-lg-12 col-sm-12" style="color:DarkBlue;"></td>').append('<span class="textLogs">' + date + '</span>' + '&nbsp;&nbsp;&nbsp;' + '<span>' + data[i].log + '</span>'));
                    }

                    $table.append($rowDiv);
                }


                if (data.length) {
                    lastTimestamp = data[data.length - 1].timestamp;
                    console.log(lastTimestamp);
                    $modalBody.append($table);
                    $modalBody.scrollTop($modalBody[0].scrollHeight + 100);
                }


                console.log('polling again');
                if ($instanceLogModalContainer.data()['bs.modal'].isShown) {
                    pollLogs(lastTimestamp, 1000, false);
                } else {
                    console.log('not polling again');
                }
            });
        }, delay);
    }
    pollLogs(lastTimestamp, 0, true);
};

function foldTreeForSetting() {
    var list = $('#setting_tree').find('.fa-angle-down'),
        len = list.length;
    for (var i = 0; i < len; i++) {
        list.eq(i).trigger('click');
    }
}


function setleftnavigation(toplink, breadcrumbHeader) {
    var TabID = $(toplink).attr('id');
    if (TabID === "workZoneNew") {
        loadTreeFuncNew();
        $('#Settings_nav').hide();
        $('#Workspace1').show();
        $('#trackShow').hide();

    } else if (TabID === "designNew") {
        $('#selectOrgName').trigger('click');
        $('#Workspace1').hide();
        $('#Settings_nav').hide();
        $('#trackShow').hide();

    } else if (TabID === "settingsNew") {
        $('#tree').empty()
        $('#trackTree').empty();
        loadSettingsTree();
        foldTreeForSetting();
        $('#Workspace1').hide();
        $('#trackShow').hide();
        $('#Settings_nav').show();

    } else if (TabID === "settingsNewClick") {
        $('#tree').empty();
        $('#trackTree').empty();
        loadSettingsTree();
        foldTreeForSetting();
        $('#Workspace1').hide();
        $('#trackShow').hide();
        $('#Settings_nav').show();

    } else if (TabID === "trackNew") {
        $('#tree').empty();
        $('#trackTree').empty();
        getTrackTreeDetails();
        loadTrackTree();
        $('#Workspace1').hide();
        $('#Settings_nav').hide();
        $('#trackShow').show();
    }

    if ($(toplink).hasClass('active')) {
        if ($(toplink).attr('id') == 'workZoneNew') {
            selectEnv();
        }
        return;
    }
    $('.navigationTab').removeClass('active').find("i").removeClass('txt-color-blue');
    $(toplink).addClass('active').find('i').addClass('txt-color-blue');
    $('nav > ul').addClass('hidden'); //hiding all navigation elements
    var navbar = $(toplink).closest("li").attr('navigation');
    $('#Workspace1').addClass('hidden');
    if (navbar.length) {
        var navs = navbar.split(',');
        for (var i = 0; i < navs.length; i++) {
            $('#' + navs[i]).removeClass('hidden').css('display', '');
        }

    }
    if (breadcrumbHeader == 'org') {
        window.selectedOrgName = $('.orgSelected').find('span').text();
    } else {
        //Reverting the warning message when no org present
        $('#content').removeClass('hidden').removeAttr('style', 'height:100% !important');
        $('#noenvwarning').addClass('hidden');
        $('#noEnvError').addClass('hidden');
        $('ol.breadcrumb').removeClass('hidden');
        window.selectedOrgName = breadcrumbHeader;
    }
    //Setting local storage with last selected tab
    localStorage.setItem("lasttabselected", $(toplink).attr('id'));
    if ($(toplink).attr('id') == 'workZoneNew') {
        selectEnv();
    }
}

//Expanding the providers tree
var serviceURL = "../d4dMasters/";
window.selectedOrgName = $('.orgSelected').text().trim();
var SettingTreeJson = [{
        "name": "organizationsetup",
        "text": "Organization Setup",
        "icon": "fa fa-lg fa-fw fa-building",
        "nodetype": "org",
        "nodes": [{
            "name": "organizations",
            "text": "Organizations",
            "borderColor": "#000",
            "href": "#ajax/Settings/OrgList.html",
            "parent": "org",
            "nodetype": "OrgList",
            "selectable": true,
            "icon": "fa fa-lg fa-fw fa-building"

        }, {
            "name": "organizations",
            "text": "Business Groups",
            "borderColor": "#000",
            "href": "#ajax/Settings/ProductGroupList.html",
            "parent": "org",
            "nodetype": "ProductGroupList",
            "selectable": true,
            "icon": "fa fa-lg fa-fw fa-th"

        }, {
            "name": "organizations",
            "text": "Projects",
            "borderColor": "#000",
            "href": "#ajax/Settings/ProjectList.html",
            "parent": "org",
            "nodetype": "ProjectList",
            "selectable": true,
            "icon": "fa fa-lg fa-fw fa-tags"

        },{
            "name": "organizations",
            "text": "Environments",
            "borderColor": "#000",
            "href": "#ajax/Settings/EnvironmentConceptList.html",
            "selectable": true,
            "icon": "fa fa-lg fa-fw fa-tint",
            "parent": "devops",
            "nodetype": "EnvironmentConceptList"
        }],
        "borderColor": "#000",
        "selectable": false,
        "href": "javascript:void(0);"


    }, {
        "name": "config setup",
        "text": "Config Setup",
        "nodes": [{
            "name": "organizations",
            "text": "Chef Server",
            "borderColor": "#000",
            "href": "#ajax/Settings/ConfigManagementList.html",
            "selectable": true,
            "icon": "fa fa-lg fa-fw fa-random"
        }, {
            "name": "organizations",
            "text": "Puppet Server",
            "borderColor": "#000",
            "href": "#ajax/Settings/PuppetServerList.html",
            "selectable": true,
            "icon": "fa fa-lg fa-fw fa-random"

        }],
        "borderColor": "#000",
        "selectable": false,
        "href": "javascript:void(0);",
        "icon": "fa-lg fa-fw fa fa-tachometer"
    },  {
        "name": "devopssetup",
        "text": "DevOps Setup",
        "icon": "fa fa-lg fa-fw fa-qrcode",
        "nodetype": "devops",
        "nodes": [{
                "name": "organizations",
                "text": "Nexus Server",
                "borderColor": "#000",
                "href": "#ajax/Settings/NexusServerList.html",
                "selectable": true,
                "icon": "fa fa-lg fa-fw fa-random"

            }, {
                "name": "organizations",
                "text": "Docker",
                "borderColor": "#000",
                "href": "#ajax/Settings/DockerTemplatesList.html",
                "selectable": true,
                "icon": "fa fa-lg fa-fw fa-hdd-o"

            }, {
                "name": "organizations",
                "text": "Jenkins",
                "borderColor": "#000",
                "href": "#ajax/Settings/JenkinsConfigList.html",
                "selectable": true,
                "icon": "fa fa-lg fa-fw fa-link"

            }, {
                "name": "organizations",
                "text": "Providers",
                "borderColor": "#000",
                "href": "#ajax/Settings/ProvidersList.html",
                "selectable": true,
                "icon": "fa fa-lg fa-fw fa-sitemap"
            }, {
                "name": "organizations",
                "text": "CMDB",
                "borderColor": "#000",
                "href": "#ajax/Settings/cmdbList.html",
                "selectable": true,
                "icon": "fa fa-lg fa-fw fa-database"
            },

        ],
        "borderColor": "#000",
        "selectable": false,
        "href": "javascript:void(0);"

    }, {
        "name": "usersetup",
        "text": "Users Setup",
        "icon": "fa fa-lg fa-fw  fa-tasks",
        "nodes": [{
            "name": "organizations",
            "text": "User Roles",
            "borderColor": "#000",
            "href": "#ajax/Settings/RolesList.html",
            "selectable": true,
            "icon": "fa fa-lg fa-fw fa-th-list"

        }, {
            "name": "organizations",
            "text": "Users",
            "borderColor": "#000",
            "href": "#ajax/Settings/UsersList.html",
            "selectable": true,
            "icon": "fa fa-lg fa-fw fa-user"

        }, {
            "name": "organizations",
            "text": "Teams",
            "borderColor": "#000",
            "href": "#ajax/Settings/TeamsList.html",
            "selectable": true,
            "icon": "fa fa-lg fa-fw fa-users"

        }],
        "borderColor": "#000",
        "selectable": false,
        "href": "javascript:void(0);"

    }, {
        "name": "gallerysetup",
        "text": "Gallery Setup",
        "icon": "fa fa-lg fa-fw fa-building",
        "nodes": [{
            "name": "templates",
            "text": "Template Types",
            "borderColor": "#000",
            "href": "#ajax/Settings/DesignTemplateTypesList.html",
            "selectable": true,
            "icon": "fa fa-lg fa-fw fa-files-o"

        }, {
            "name": "organizations",
            "text": "Templates",
            "borderColor": "#000",
            "href": "#ajax/Settings/TemplatesList.html",
            "selectable": true,
            "icon": "fa fa-lg fa-fw fa-files-o"

        }, {
            "name": "organizations",
            "text": "Service Command",
            "borderColor": "#000",
            "href": "#ajax/Settings/ServiceCommandList.html",
            "selectable": true,
            "icon": "fa fa-lg fa-fw fa-terminal"

        }, {
            "name": "organizations",
            "text": "VMImage",
            "borderColor": "#000",
            "href": "#ajax/Settings/ImagesList.html",
            "selectable": true,
            "icon": "fa fa-lg fa-fw fa-image"

        }],
        "borderColor": "#000",
        "selectable": false,
        "href": "javascript:void(0);"

    }, {
        "name": "track",
        "text": "Track Setup",
        "nodes": [{
            "name": "templates",
            "text": "Dashboards",
            "borderColor": "#000",
            "href": "#ajax/Settings/DashboardSettings.html",
            "selectable": true,
            "icon": "fa fa-lg fa-fw fa-files-o"
        }],
        "borderColor": "#000",
        "selectable": false,
        "href": "javascript:void(0);",
        "icon": "fa-lg fa-fw fa fa-tachometer"
    }, {
        "name": "userguide",
        "text": "User Information",
        "borderColor": "#000",
        "nodes": [{
            "name": "Guide",
            "text": "User Guide",
            "borderColor": "#000",
            "href": "ajax/Settings/Catalyst-Guide.html",
            "selectable": true,
            "icon": "fa fa-lg fa-fw fa-file-pdf-o",
            "target": "_blank",
        }, {
            "name": "Guide",
            "text": "Videos",
            "borderColor": "#000",
            "href": "#ajax/Settings/videos.html",
            "selectable": true,
            "icon": "fa fa-lg fa-fw fa-file-video-o",
        }],
        "selectable": false,
        "href": "javascript:void(0);",
        "icon": "fa-lg fa-fw fa fa-book"
    }

];

function loadSettingsTree() {
    $('#setting_tree').empty().treeview({
        data: SettingTreeJson,
        enableLinks: true,
        collapseIcon: 'fa fa-angle-down',
        expandIcon: 'fa fa-angle-right',
        levels: -1,
        onNodeSelected: function(event, node) {
            drawBreadCrumb1();
            event.stopPropagation();
        }
    });

}
var trackTree;

function getTrackTreeDetails() {
    $.ajax({
        type: "get",
        dataType: "json",
        async: false,
        url: '../track',
        success: function(data) {
            trackTree = [];

            for (var i = 0; i < data.length; i++) {
                trackTree.push({
                    "name": "data",
                    "text": data[i].type,
                    "icon": "icon fa fa-line-chart",
                    "nodetype": "data",
                    "nodes": [],
                    "borderColor": "#000",
                    "selectable": false,
                    "href": "javascript:void(0);"
                });
                for (var j = 0; j < data[i].itemUrls.length; j++) {
                    if (data[i].itemUrls[j].childItem.length > 0) {
                        trackTree[i].nodes.push({
                            "name": "parentData",
                            "text": data[i].itemUrls[j].name,
                            "borderColor": "#000",
                            "href": 'javascript:void(0)',
                            "parent": "data",
                            "data-href": data[i].itemUrls[j].url,
                            "nodetype": "parentNode",
                            "selectable": false,
                            "icon": "icon fa fa-lg fa-fw fa-files-o",
                            "nodes": []
                        });
                        console.log("TrackAfter" + JSON.stringify(trackTree));
                    } else {
                        trackTree[i].nodes.push({
                            "name": "parentData",
                            "text": data[i].itemUrls[j].name,
                            "borderColor": "#000",
                            "href": 'javascript:void(0)',
                            "parent": "data",
                            "data-href": data[i].itemUrls[j].url,
                            "nodetype": "parentNode",
                            "selectable": true,
                            "icon": "icon fa fa-lg fa-fw fa-files-o"
                        });
                    }
                    console.log("TrackTree" + JSON.stringify(trackTree[0].nodes));

                    for (var k = 0; k < data[i].itemUrls[j].childItem.length; k++) {
                        trackTree[i].nodes[j].nodes.push({
                            "name": "childData",
                            "text": data[i].itemUrls[j].childItem[k].name,
                            "borderColor": "#000",
                            "href": 'javascript:void(0)',
                            "parent": "data",
                            "data-href": data[i].itemUrls[j].childItem[k].url,
                            "nodetype": "childType",
                            "selectable": true,
                            "icon": "fa fa-fw fa-1x fa-desktop"
                        });
                    }
                }
            }
            console.log(JSON.stringify(trackTree));
        }
    })
}

function loadTrackTree() {
    $('#trackTree').treeview({
        data: trackTree,
        enableLinks: true,
        collapseIcon: 'fa fa-angle-down',
        expandIcon: 'fa fa-angle-right',
        levels: -1,
        onNodeSelected: function(event, node) {
            $("#content").empty();
            $("#content").attr('style', 'height: 100%!important').append('<iframe src=' + node['data-href'] + ' style="width: 101% ! important; height: 97%! important; border: medium none;"></iframe>');
            console.log($("#content")[0].innerHTML);
            event.stopPropagation();
            event.preventDefault();
            event.stopPropagation();
            return false;
        }
    });
}

var treeData;

function getTreeData() {
    $.ajax({
        type: "get",
        dataType: "json",
        async: false,
        url: "../organizations/getTreeForbtv",
        success: function(data1) {
            treeData = data1;
        }
    });

}

function buildTree() {
    $('#tree').empty().treeview({
        data: treeData,
        enableLinks: true,
        collapseIcon: 'fa fa-angle-down',
        expandIcon: 'fa fa-angle-right',
        levels: 1,
        onNodeSelected: function(event, node) {

            window.selectedOrgName = $('li[data-nodeid="' + node.nodeId + '"]').first().find('a').first().attr('orgname');
            localStorage.setItem('selectedOrgName', $('li[data-nodeid="' + node.nodeId + '"]').first().find('a').first().attr('orgname'));
            localStorage.setItem('selectedOrgId', $('li[data-nodeid="' + node.nodeId + '"]').first().find('a').first().attr('orgid'));
            /*Description from the node*/
            localStorage.setItem("orgname", node.orgname);
            localStorage.setItem("projname", node.projname ? node.projname : node.text);
            localStorage.setItem("bgname", node.bgname);
            localStorage.setItem("envname", node.text);
            localStorage.setItem('itProjectActive', 'no');

            /*Draw the breadcrumb from ol*/
            var ol = $("#ribbon ol.breadcrumb");
            if (ol.children().length == 0) {
                drawBreadCrumb();
            }
            if (node.hasOwnProperty('itemtype') && node.itemtype === "proj") {
                localStorage.setItem('itProjectActive', 'yes');
            }

        }
    });
}

var loadTreeFuncNew = function(lazy) {
    console.log('Loaded a tree');
    if (lazy) {
        buildTree();
    } else {
        getTreeData();
        buildTree();
    }

}



function getUrlParameter(sParam) {
    var u = $('#workZoneNew').attr('href').split('?');
    var sPageURL = u[1];
    if (typeof sPageURL != 'undefined') {
        var sURLVariables = sPageURL.split('&');
        for (var i = 0; i < sURLVariables.length; i++) {
            var sParameterName = sURLVariables[i].split('=');
            if (sParameterName[0] == sParam) {
                return sParameterName[1];
            }
        }
    } else {
        //check local storage for last env clicked.
        var lastwzurl = localStorage.getItem("lastworkzoneurl");
        if (lastwzurl) {
            u = lastwzurl.split('?');
            sPageURL = u[1];
            if (typeof sPageURL != 'undefined') {
                var sURLVariables = sPageURL.split('&');
                for (var i = 0; i < sURLVariables.length; i++) {
                    var sParameterName = sURLVariables[i].split('=');
                    if (sParameterName[0] == sParam) {
                        return sParameterName[1];
                    }
                }
            } else
                return ('');

        } else
            return ('');
    }
    return ('');
}

$(document).keypress("l", function(e) {
    if (e.ctrlKey && e.altKey && (String.fromCharCode(e.which) === 'l' || String.fromCharCode(e.which) === 'L')) {
        window.open('/private/catlog.html', 'Catalyst Log');
    }
});



window.getUrlParams = function(url) {
    var urlParams = {};
    var indexOfQues = url.lastIndexOf("?");
    if (indexOfQues != -1) {
        var sub = url.substring(indexOfQues + 1);
        console.log(sub);
        var params = sub.split('&')
        for (var i = 0; i < params.length; i++) {
            var paramParts = params[i].split('=');
            urlParams[paramParts[0]] = paramParts[1];
        }
    }
    return urlParams;

};

function selectFirstEnvironment() {
    var $workspaceTree = $('#Workspace1');
    var $orgLink = $workspaceTree.find('a[itemtype="org"][bgId][projId][envId]');
    if ($orgLink.length) {
        $orgLink = $orgLink.first().click();
        console.log(' envIds===   ', $orgLink.attr('bgId'), $orgLink.attr('projId'), $orgLink.attr('envId'));
        var $bgLink = $workspaceTree.find('a[rowid="' + $orgLink.attr('bgId') + '"]').click();
        var $projLink = $workspaceTree.find('a[rowid="' + $orgLink.attr('projId') + '"]').click();
        var $envLink = $workspaceTree.find('a[rowid="' + $orgLink.attr('envId') + '"]');
        $('#workZoneNew').attr('href', $envLink.attr('href'));
        $envLink.click();
        return true;
    } else {
        $('#workZoneNew').attr('href', '#');
        return false;
    }
}

function selectEnv() {
    var $workspaceTree = $('#Workspace1');
    var url = localStorage.getItem("lastworkzoneurl");
    if (!url) {
        url = window.location.href;
    }
    var urlParams = getUrlParams(url);
    console.log(urlParams);
    var $orgLink;

    var envFound = false;
    if (urlParams.envid && urlParams.org && urlParams.bg && urlParams.projid) { //finding env
        var treeNodes = [];

        $orgLink = $workspaceTree.find('a[itemtype="org"][rowid="' + urlParams.org + '"]');
        if ($orgLink.length) {
            $orgLink.click();
            treeNodes.push($orgLink);

        }
        var $bgLink = $workspaceTree.find('a[rowid="' + urlParams.bg + '"]');
        if ($bgLink.length) {
            $bgLink.click();
            treeNodes.push($bgLink);
        }
        var $projLink = $workspaceTree.find('a[rowid="' + urlParams.projid + '"]');
        if ($projLink.length) {
            $projLink.click();
            treeNodes.push($projLink);
        }
        var $envLink = $workspaceTree.find('a[rowid="' + urlParams.envid + '"]');
        if ($envLink.length) {
            $envLink = $envLink.first().click();
            console.log('ancor a ==>', $envLink.attr('href'));
            $('#workZoneNew').attr('href', $envLink.attr('href'));
            treeNodes.push($envLink);
            envFound = true;
        }
        if (!envFound) {
            console.log('treenodes', treeNodes);
            for (var i = treeNodes.length - 1; i >= 0; i--) {
                treeNodes[i].click();
            }
            loadTreeFuncNew(true);
            envFound = selectFirstEnvironment();
        }


    } else {
        //not found ... trying to find first element in any org
        envFound = selectFirstEnvironment();
    }
    if (!envFound) {
        $('#content').addClass('hidden');
        $('#noenvwarning').removeClass('hidden');
        $('ol.breadcrumb').addClass('hidden');
    } else {
        $('#content').removeClass('hidden').removeAttr('style', 'height:100% !important');
    }
}

//Renavigate to the tab that was previously selected.
checkandnavigatetotab = function() {
    //has tab in LS
    var ltab = localStorage.getItem("lasttabselected");
    if (ltab) {
        $('#' + ltab).trigger('click');
        drawBreadCrumb();
    } else { //will be a first time load
        console.log('selecting first env');
        $('#workZoneNew').trigger('click');
    }
};
checkandnavigatetotab();
loadSettingsTree();
foldTreeForSetting();

function generateCompositeJsonfromtable() {
    var dockercompose = [];
    var dockerimages = {};
    $('.dockerImagesRowDesign').each(function() {
        dockerimages = {};
        $(this).find('[paramtype]').each(function() {
            if ($(this).attr('paramtype') == 'dockercontainerpaths') {
                dockerimages[$(this).attr('paramtype')] = $(this).text() + $(this).val();
            } else
                dockerimages[$(this).attr('paramtype')] = $(this).text() + $(this).val();
        });
        $(this).find()
        dockercompose.push(dockerimages);
    });
    return (dockercompose);
}
function compositeDockerLaunch(data){
  var compositedockerimage = generateCompositeJsonfromtable();
  compositedockerimage = JSON.stringify(compositedockerimage);
  if (!$('.instanceselectedfordocker:checked').length) {
      bootbox.confirm({
          message: "Please select atleast one instance.",
          title: "Warning",
          callback: function(result) {}
      });
      return;
  }
  $('.instanceselectedfordocker:checked').each(function() {
      var repopath = "null"; //would be referenced from the json supplied.
      var instid = $(this).closest('tr').find('.dockerinstanceClass').attr('data-instanceid');
      var instbpname = $(this).closest('tr').find('.dockerinstanceClass').attr('data-blueprintname');
      var amoreinfo = $(this).closest('tr').find('.moreInfo');
      if (instid)
          var $that = $(this);
      var $td = $that.closest('td');

      var tdtext = $td.text();
      $td.find('.dockerspinner').detach();
      $td.find('.dockermessage').detach();
      $td.append('<img class="dockerspinner" style="margin-left:5px" src="img/select2-spinner.gif"></img>');
      $td.attr('title', 'Pulling in Images');
      $.post('../instances/dockercompositeimagepull/' + instid + '/' + repopath, {
          compositedockerimage: encodeURIComponent(compositedockerimage)
      }, function(dockerData) {
          if (dockerData == "OK") {
              if (amoreinfo)
                  amoreinfo.trigger('click');

              var $statmessage = $td.find('.dockerspinner').parent();
              $td.find('.moreInfo').first().click(); //showing the log window.
              $td.find('.dockerspinner').detach();
              $statmessage.append('<span style="margin-left:5px;text-decoration:none" class="dockermessage"></span>');
              //Updated from above to move docker image out of circle.
              $dockericon = $('<img src="img/galleryIcons/Docker.png" alt="Docker" style="width:auto;height:27px;margin-left:96px;margin-top:-105px" class="dockerenabledinstacne"/>');
              //find the instance card - to do instance table view update
              var $instancecard = $('div[data-instanceid="' + instid + '"]');
              if ($instancecard.find('.dockerenabledinstacne').length <= 0) {
                  $instancecard.find('.componentlistContainer').first().append($dockericon);
              }
          } else {
              if (dockerData.indexOf('No Docker Found') >= 0) {
                  var $statmessage = $('.dockerspinner').parent();
                  $('.dockerspinner').detach();
                  $td.find('.dockermessage').detach();
                  $statmessage.append('<span style="margin-left:5px;color:red" title="Docker not found"  class="dockermessage"><i class="fa  fa-exclamation"></i></span>');
                  //Prompt user to execute the docker cookbook.
                    bootbox.alert('Docker was not found on the node : "' + instbpname + '". \n Kindly navigate to Workzone and run Chef Client Run');
                        //Docker launcer popup had to be hidden due to overlap issue.
                        $('#launchDockerInstanceSelector').modal('hide');
                        return false;
              } else {
                  var $statmessage = $('.dockerspinner').parent();
                  $('.dockerspinner').detach();
                  $td.find('.dockermessage').detach();
                  $statmessage.append('<span style="margin-left:5px;color:red" title="' + dockerData + '"  class="dockermessage"><i class="fa  fa-exclamation"></i></span>');
              }
          }
      });
  });
}


//initialising dockerInstance datatable.
if (!$.fn.dataTable.isDataTable('#dockerinstancesTable')) {
var $dockerinstancesDatatable = $('#dockerinstancesTable').DataTable({
    "pagingType": "full_numbers",
    "aaSorting": [
        [0, "desc"]
    ],
    "aoColumns": [{
        "bSortable": false
    }, {
        "bSortable": true
    }, {
        "bSortable": true
    }, {
        "bSortable": false
    }]

  });
}

var $dockerWizard = $('#rootwizard').bootstrapWizard({
    'tabClass': 'nav nav-pills',
    'onNext': function(tab, navigation, index) {
        $('.dockerinstancestart').first().removeClass('hidden');
        var $valid = $("#commentForm").valid();
        if (!$valid) {
            $validator.focusInvalid();
            return false;
        }
    },
    'onPrevious': function(tab, navigation, index) {
        $('.dockerinstancestart').first().addClass('hidden');
    }
});
</script>

<script src="js/chefmodalcommon.js"></script>
<script src="js/jquerytemplatemin.js"></script>
<script src="/private/js/settingscommon.js"></script>

<div id="myModal" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                 <h4 class="modal-title">Catalyst Log</h4>

            </div>
            <div class="modal-body"  >
                <div id="launchcatalystlogwindow" style="overflow:auto;height:400px;font-size:8pt;" >
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>
</body>
</html>
